(function(e){function t(t){for(var a,r,o=t[0],c=t[1],l=t[2],d=0,h=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&h.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},s=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/bushu-app/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"034f":function(e,t,n){"use strict";n("85ec")},"035d":function(e,t,n){e.exports=n.p+"img/dragHandle.71056405.svg"},"0747":function(e,t,n){"use strict";n("fd94")},"0cad":function(e,t,n){"use strict";n("97c5")},"1f8f":function(e,t,n){"use strict";n("8774")},2303:function(e,t,n){"use strict";n("fb9a")},"3cd8":function(e,t,n){e.exports=n.p+"img/b314_icon_inner.e3e60166.svg"},"3da0":function(e,t,n){"use strict";n("ec5d")},"3e98":function(e,t,n){},4531:function(e,t,n){},4678:function(e,t,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf755","./tlh.js":"cf755","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=s,e.exports=i,i.id="4678"},4821:function(e,t,n){e.exports=n.p+"img/b_favicon.2f70cbe0.svg"},"50b6":function(e,t,n){},5964:function(e,t,n){"use strict";n("4531")},"6b8a":function(e,t,n){},7600:function(e,t,n){"use strict";n("8306")},"80c2":function(e,t,n){"use strict";n("d597")},8306:function(e,t,n){},"85ec":function(e,t,n){},8774:function(e,t,n){},8940:function(e,t,n){"use strict";n("eb27")},"97c5":function(e,t,n){},"9b1a":function(e,t,n){"use strict";n("e30f")},"9e3c":function(e,t,n){},bb5b:function(e,t,n){"use strict";n("9e3c")},c6ae:function(e,t,n){},caf0:function(e,t,n){"use strict";n("6b8a")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("app-header")],1),n("router-view")],1)},s=[],r=n("1da1"),o=(n("d3b7"),n("3ca3"),n("ddb0"),n("9861"),n("ac1f"),n("841c"),n("96cf"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-navbar",{attrs:{toggleable:"lg",fixed:"top",type:"dark",variant:"secondary"}},[a("b-navbar-brand",{attrs:{to:"/"}},[a("img",{staticStyle:{height:"30px"},attrs:{src:n("4821"),alt:"B icon"}}),e._v(" BushuApp ")]),a("b-navbar-toggle",{attrs:{target:"headerOptions"}}),a("b-collapse",{attrs:{id:"headerOptions","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/"}},[e._v("Home")]),a("b-nav-item-dropdown",{attrs:{text:"Apps"}},[a("b-dropdown-item",{attrs:{to:"/watchlist"}},[e._v("Watchlist")]),a("b-dropdown-item",{attrs:{to:"/miscTools"}},[e._v("Misc Tools Gallery")])],1)],1),a("b-navbar-nav",{staticClass:"ml-auto"},[a("dropbox-sign-in")],1)],1)],1),a("div",{style:"height: 58px; width: 100%"})],1)}),c=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"sign-in-button",on:{click:function(t){return e.openModal()}}},[e.$store.state.isLoading?n("b-spinner",{staticStyle:{margin:"5px"},attrs:{variant:"secondary"}}):e.isSignedIn?n("div",[n("b-avatar",{staticStyle:{"margin-right":"10px"},attrs:{size:"34",src:e.imgLink}}),e._v(" Hi "+e._s(e.userShortName)+" ")],1):n("div",[e._v(" Sign in with Dropbox ")])],1),n("b-modal",{attrs:{id:"loginModal",title:"Dropbox Sign In","hide-footer":"",centered:""}},[n("div",{staticClass:"sign-in-modal-content"},[e.isSignedIn?n("p",[e._v(" Currently signed in as "+e._s(e.userFullName)+". ")]):n("p",[e._v(" Sign in with your Dropbox account to be able to load and save custom user data and settings. ")]),n("div",[e.isSignedIn?e._e():n("b-form-checkbox",{model:{value:e.doRememberMe,callback:function(t){e.doRememberMe=t},expression:"doRememberMe"}},[e._v(" Remember Me ")]),n("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(t){return e.closeModal()}}},[e._v(" Cancel ")]),e.isSignedIn?n("b-button",{attrs:{variant:"danger"},on:{click:function(t){return e.signOut()}}},[e._v(" Disconnect Account ")]):n("b-button",{attrs:{variant:"success"},on:{click:function(t){return e.openSignInScreen()}}},[e._v(" Sign In ")])],1)])])],1)},u=[],d=(n("b0c0"),n("5319"),n("e9c4"),n("bc3a")),h=n.n(d),m=n("2f62"),p={state:{db_accessToken:"",db_userInfo:null},getters:{db_isLoggedIn:function(e){return null!==e.db_userInfo},db_isReady:function(e){return""!==e.db_accessToken}},mutations:{setAccessToken:function(e,t){e.db_accessToken=t},setUserInfo:function(e,t){e.db_userInfo=t}},actions:{updateAccessToken:function(e,t){e.commit("setAccessToken",t)},updateUserInfo:function(e,t){e.commit("setUserInfo",t)}}},f=(n("7db0"),n("c740"),n("2909")),v=(n("d81d"),n("07ac"),n("4e82"),n("1276"),n("159b"),n("99af"),n("b64b"),n("6062"),n("25f0"),n("fb2c"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("a15b"),n("a630"),n("466d"),n("5cc6"),{dec2hex:function(e){return("0"+e.toString(16)).substr(-2)},generateRandomHexString:function(){var e=new Uint32Array(32);return window.crypto.getRandomValues(e),Array.from(e,this.dec2hex).join("")},hexToBase64:function(e){var t=e.match(/\w{2}/g);return null!==t?btoa(t.map((function(e){return String.fromCharCode(parseInt(e,16))})).join("")):""},base64URLEncode:function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},generateCodeVerifier:function(){return this.base64URLEncode(this.hexToBase64(this.generateRandomHexString()))},sha256:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,s,r,o,c,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=new TextEncoder,i=a.encode(e),n.next=4,window.crypto.subtle.digest("SHA-256",i);case 4:for(s=n.sent,r=new Uint8Array(s),o=r.byteLength,c="",l=0;l<o;l++)c+=String.fromCharCode(r[l]);return n.abrupt("return",t.base64URLEncode(btoa(c)));case 10:case"end":return n.stop()}}),n)})))()},deepClone:function(e){return JSON.parse(JSON.stringify(e))},pluralFormat:function(e,t){return"".concat(e," ").concat(t).concat(1===e?"":"s")},getGUID:function(){return"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,(function(e){var t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))},getTimestamp:function(){return(new Date).toISOString()},getFormattedDate:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Date(e).toLocaleDateString("en-US",t?{timeZone:"UTC"}:void 0)},getToday:function(){return(new Date).toLocaleString("sv").substring(0,10)}}),g="/Watchlist/shows.json",b="/Watchlist/seasons.json",w="/Watchlist/watchlistData.json",y="/Watchlist/seasonViews.json",x={},S={},k={},C={},_=void 0;function I(){return T.apply(this,arguments)}function T(){return T=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]&&a[0],!t&&0!==Object.keys(x).length){e.next=7;break}return e.next=4,F.getData(g);case 4:n=e.sent,null===n&&(n={}),x=n;case 7:return e.abrupt("return",x);case 8:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function R(){return z.apply(this,arguments)}function z(){return z=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]&&a[0],!t&&0!==Object.keys(S).length){e.next=7;break}return e.next=4,F.getData(b);case 4:n=e.sent,null===n&&(n={}),S=n;case 7:return e.abrupt("return",S);case 8:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function D(){return j.apply(this,arguments)}function j(){return j=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]&&a[0],!t&&0!==Object.keys(k).length){e.next=7;break}return e.next=4,F.getData(y);case 4:n=e.sent,null===n&&(n={}),k=n;case 7:return e.abrupt("return",k);case 8:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function L(){return E.apply(this,arguments)}function E(){return E=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F.getData(w);case 2:return t=e.sent,null===t&&(t={mainSeasonViewIds:[],liveSeasonViewIds:[],queueSeasonViewIds:[],upcomingShowSeasonIds:[],backlogShowInfoIds:[]}),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function M(e){return O.apply(this,arguments)}function O(){return O=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,s,r,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],a=Object(f["a"])(new Set(t)),e.next=4,I(n);case 4:return i=e.sent,e.next=7,R(n);case 7:return s=e.sent,r={},a.forEach((function(e){var t=i[e];r[e]={id:e,title:t.title,altTitle:t.altTitle,isAnime:t.isAnime,doEpisodeCountOverall:t.doEpisodeCountOverall,seasonCount:t.seasonCount,seasons:t.showSeasonIds.map((function(e){return s[e]})),imgLink:t.imgLink}})),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function A(e){return P.apply(this,arguments)}function P(){return P=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,s,r,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],a=Object(f["a"])(new Set(t)),e.next=4,D(n);case 4:return i=e.sent,e.next=7,R(n);case 7:return s=e.sent,r={},a.forEach((function(e){var t=i[e];r[e]={id:e,seasonInfo:s[t.showSeasonId],watchedEpisodes:t.watchedEpisodes,currentEpisodeCount:t.currentEpisodeCount,beganDate:t.beganDate,completedDate:t.completedDate,droppedDate:t.droppedDate}})),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}var V={GetCatalog:function(){return Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return t=e.sent,e.next=5,R();case 5:return n=e.sent,a=Object.values(t).map((function(e){return{id:e.id,title:e.title,altTitle:e.altTitle,isAnime:e.isAnime,doEpisodeCountOverall:e.doEpisodeCountOverall,seasonCount:e.seasonCount,seasons:e.showSeasonIds.map((function(e){return n[e]})),imgLink:e.imgLink}})),a.sort((function(e,t){var n=e.title.toLowerCase().split(/^the /).reverse()[0],a=t.title.toLowerCase().split(/^the /).reverse()[0];return n.localeCompare(a)})),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))()},SaveCatalog:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},a={},e.forEach((function(e){e.seasons.forEach((function(e){a[e.id]=e}));var t={id:e.id,title:e.title,altTitle:e.altTitle,isAnime:e.isAnime,doEpisodeCountOverall:e.doEpisodeCountOverall,seasonCount:e.seasonCount,imgLink:e.imgLink,showSeasonIds:e.seasons.map((function(e){return e.id}))};n[e.id]=t})),t.next=5,F.saveData(g,n);case 5:return t.next=7,F.saveData(b,a);case 7:x=n,S=a;case 9:case"end":return t.stop()}}),t)})))()},UpdateShowSeason:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,R();case 2:return n=t.sent,n[e.id]=e,t.next=6,F.saveData(b,n);case 6:S=n;case 7:case"end":return t.stop()}}),t)})))()},GetWatchlistData:function(){var e=arguments;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,s,r,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]&&e[0],t.next=3,L();case 3:return a=t.sent,i=[].concat(Object(f["a"])(a.mainSeasonViewIds),Object(f["a"])(a.liveSeasonViewIds),Object(f["a"])(a.queueSeasonViewIds)),t.next=7,A(i,n);case 7:return s=t.sent,t.next=10,M(a.backlogShowInfoIds,n);case 10:return r=t.sent,t.next=13,R(n);case 13:return o=t.sent,c={main:a.mainSeasonViewIds.map((function(e){return s[e]})),live:a.liveSeasonViewIds.map((function(e){return s[e]})),queue:a.queueSeasonViewIds.map((function(e){return s[e]})),upcoming:a.upcomingShowSeasonIds.map((function(e){return o[e]})),backlog:a.backlogShowInfoIds.map((function(e){return r[e]}))},t.abrupt("return",c);case 16:case"end":return t.stop()}}),t)})))()},SaveWatchlistData:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=[].concat(Object(f["a"])(e.main),Object(f["a"])(e.live),Object(f["a"])(e.queue)),n.next=3,t.SaveSeasonViews(a);case 3:return i={mainSeasonViewIds:e.main.map((function(e){return e.id})),liveSeasonViewIds:e.live.map((function(e){return e.id})),queueSeasonViewIds:e.queue.map((function(e){return e.id})),upcomingShowSeasonIds:e.upcoming.map((function(e){return e.id})),backlogShowInfoIds:e.backlog.map((function(e){return e.id}))},n.next=6,F.saveData(w,i);case 6:case"end":return n.stop()}}),n)})))()},SaveSeasonViews:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,D();case 2:return n=t.sent,a=v.deepClone(n),e.forEach((function(e){a[e.id]={id:e.id,showSeasonId:e.seasonInfo.id,watchedEpisodes:e.watchedEpisodes,currentEpisodeCount:e.currentEpisodeCount,beganDate:e.beganDate,completedDate:e.completedDate,droppedDate:e.droppedDate}})),k=a,t.next=8,F.saveData(y,a);case 8:case"end":return t.stop()}}),t)})))()},SaveSeasonViewDebounced:function(e){var t=this,n=3;C[e.id]=e,window.clearTimeout(_),_=window.setTimeout((function(){var e=Object.values(C);t.SaveSeasonViews(e),C={},_=void 0}),1e3*n)},ForceSaveSeasonViews:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(Object.keys(C).length>0)){t.next=7;break}return window.clearTimeout(_),_=void 0,n=Object.values(C),t.next=6,e.SaveSeasonViews(n);case 6:C={};case 7:case"end":return t.stop()}}),t)})))()}},$={state:{isLoading:!1,isUpdatingSeason:!1,catalog:[]},getters:{getShowInfoById:function(e){return function(t){return e.catalog.find((function(e){return e.id===t}))}},getShowImageLink:function(){return function(e){if(e.imgLink)return e.imgLink;var t=v.deepClone(e.seasons),n=t.reverse().findIndex((function(e){return e.imgLink}));return-1===n?"":t[n].imgLink}},getImageLink:function(e,t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=t.getShowInfoById(e);if(a){var i=a.seasons.find((function(e){return e.id===n}));return i&&i.imgLink?i.imgLink:t.getShowImageLink(a)}return""}}},mutations:{setIsLoading:function(e,t){e.isLoading=t},setIsUpdatingSeason:function(e,t){e.isUpdatingSeason=t},setCatalog:function(e,t){e.catalog=t},setCatalogShowSeason:function(e,t){var n=e.catalog.findIndex((function(e){return e.id===t.showId}));if(-1!==n){var a=e.catalog[n].seasons.findIndex((function(e){return e.id===t.id}));-1!==a&&(e.catalog[n].seasons[a]=t)}}},actions:{updateCatalog:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.commit("setIsLoading",!0),n.next=3,V.SaveCatalog(t);case 3:e.commit("setCatalog",t),e.commit("setIsLoading",!1);case 5:case"end":return n.stop()}}),n)})))()},updateCatalogShowSeason:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.commit("setIsUpdatingSeason",!0),n.next=3,V.UpdateShowSeason(t);case 3:e.commit("setCatalogShowSeason",t),e.commit("setIsUpdatingSeason",!1);case 5:case"end":return n.stop()}}),n)})))()},loadCatalogFromDropbox:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit("setIsLoading",!0),t.next=3,V.GetCatalog();case 3:n=t.sent,e.commit("setCatalog",n),e.commit("setIsLoading",!1);case 6:case"end":return t.stop()}}),t)})))()}}};a["default"].use(m["a"]);var W=new m["a"].Store({state:{isLoading:!1,userWidgets:[],accessTokens:{}},mutations:{setIsLoading:function(e,t){e.isLoading=t},setUserWidgets:function(e,t){e.userWidgets=t},setSingleAccessToken:function(e,t){e.accessTokens[t.key]=t.value},setAccessTokens:function(e,t){e.accessTokens=t}},actions:{updateIsLoading:function(e,t){e.commit("setIsLoading",t)},updateUserWidgets:function(e,t){e.commit("setUserWidgets",t)},updateSingleAccessToken:function(e,t){e.commit("setSingleAccessToken",t)},updateAccessTokens:function(e,t){e.commit("setAccessTokens",t)}},modules:{dropbox:p,watchlist:$}}),N=a["default"].prototype,B="q9aarn0najvippt",U=window.location.origin+"/bushu-app/",q={settingsPath:"/General/settings.json",tokensPath:"/General/Private/tokens.json"};function H(){return"Bearer ".concat(""===W.state.dropbox.db_accessToken?"invalidToken":W.state.dropbox.db_accessToken)}var F={authorizeWithDropbox:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=v.generateCodeVerifier(),t.next=3,v.sha256(n);case 3:a=t.sent,N.$cookies.set("code_verifier",n,300),i="https://www.dropbox.com/oauth2/authorize"+"?client_id=".concat(B)+"&redirect_uri=".concat(encodeURIComponent(U))+"&code_challenge_method=S256"+"&code_challenge=".concat(a)+(e?"&token_access_type=offline":"")+"&response_type=code",window.location.replace(i);case 7:case"end":return t.stop()}}),t)})))()},handleDropboxOAuthRedirect:function(e,t){return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a="https://api.dropbox.com/oauth2/token"+"?client_id=".concat(B)+"&redirect_uri=".concat(encodeURIComponent(U))+"&code_verifier=".concat(t)+"&code=".concat(e)+"&grant_type=authorization_code",n.next=3,h.a.post(a);case 3:i=n.sent,s=i.data,s.refresh_token?N.$cookies.set("db_refresh",s.refresh_token,-1):N.$cookies.remove("db_refresh"),W.dispatch("updateAccessToken",s.access_token);case 7:case"end":return n.stop()}}),n)})))()},disconnectAccount:function(){W.dispatch("updateAccessToken",""),W.dispatch("updateUserInfo",null),N.$cookies.remove("db_refresh")},tryRefreshAccessToken:function(){return Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=N.$cookies.get("db_refresh"),!t){e.next=16;break}return n="https://api.dropbox.com/oauth2/token"+"?client_id=".concat(B)+"&refresh_token=".concat(t)+"&grant_type=refresh_token",e.prev=3,e.next=6,h.a.post(n);case 6:return a=e.sent,i=a.data,W.dispatch("updateAccessToken",i.access_token),e.abrupt("return",!0);case 12:e.prev=12,e.t0=e["catch"](3),s=e.t0,!s.response||400!==s.response.status&&401!==s.response.status||(N.$cookies.remove("db_refresh"),alert("Dropbox login expired. Please log in again."));case 16:return W.dispatch("updateAccessToken",""),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[3,12]])})))()},getData:function(e){var t=arguments,n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s,r,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:0,s="https://content.dropboxapi.com/2/files/download",r={path:e},a.prev=3,a.next=6,h.a.post(s,null,{headers:{Authorization:H(),"Dropbox-API-Arg":JSON.stringify(r),"Content-Type":"text/plain"}});case 6:return o=a.sent,a.abrupt("return",o.data);case 10:if(a.prev=10,a.t0=a["catch"](3),c=a.t0,!c.response||401!==c.response.status){a.next=25;break}if(a.t1=i<3,!a.t1){a.next=19;break}return a.next=18,n.tryRefreshAccessToken();case 18:a.t1=a.sent;case 19:if(!a.t1){a.next=23;break}return a.next=22,n.getData(e,++i);case 22:return a.abrupt("return",a.sent);case 23:a.next=27;break;case 25:if(!c.response||409!==c.response.status){a.next=27;break}return a.abrupt("return",null);case 27:throw a.t0;case 28:case"end":return a.stop()}}),a,null,[[3,10]])})))()},saveData:function(e,t){var n=arguments,a=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var s,r,o,c,l,u;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s=n.length>2&&void 0!==n[2]?n[2]:0,r="https://content.dropboxapi.com/2/files/upload",o={path:e,autorename:!0,mode:"overwrite"},c=new Blob([JSON.stringify(t,null,2)]),i.next=6,c.arrayBuffer();case 6:return l=i.sent,i.prev=7,i.next=10,h.a.post(r,l,{headers:{Authorization:H(),"Dropbox-API-Arg":JSON.stringify(o),"Content-Type":"application/octet-stream"}});case 10:i.next=26;break;case 12:if(i.prev=12,i.t0=i["catch"](7),u=i.t0,console.log("save failed:"),console.log(u),!u.response||401!==u.response.status){i.next=26;break}if(i.t1=s<3,!i.t1){i.next=23;break}return i.next=22,a.tryRefreshAccessToken();case 22:i.t1=i.sent;case 23:if(!i.t1){i.next=26;break}return i.next=26,a.saveData(e,t,++s);case 26:case"end":return i.stop()}}),i,null,[[7,12]])})))()},loadUserInfo:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:0,i="https://api.dropboxapi.com/2/users/get_current_account",n.prev=2,n.next=5,h.a.post(i,null,{headers:{Authorization:H(),"Content-Type":"application/json"}});case 5:s=n.sent,W.dispatch("updateUserInfo",s.data),n.next=20;break;case 9:if(n.prev=9,n.t0=n["catch"](2),r=n.t0,!r.response||401!==r.response.status){n.next=20;break}if(n.t1=a<3,!n.t1){n.next=18;break}return n.next=17,t.tryRefreshAccessToken();case 17:n.t1=n.sent;case 18:if(!n.t1){n.next=20;break}t.loadUserInfo(++a);case 20:case"end":return n.stop()}}),n,null,[[2,9]])})))()},getFolders:function(e){var t=arguments,n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s,r,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:0,s="https://api.dropboxapi.com/2/files/list_folder",r={path:e,recursive:!0},a.prev=3,a.next=6,h.a.post(s,r,{headers:{Authorization:H(),"Content-Type":"application/json"}});case 6:return o=a.sent,a.abrupt("return",o.data);case 10:if(a.prev=10,a.t0=a["catch"](3),c=a.t0,!c.response||401!==c.response.status){a.next=23;break}if(a.t1=i<3,!a.t1){a.next=19;break}return a.next=18,n.tryRefreshAccessToken();case 18:a.t1=a.sent;case 19:if(!a.t1){a.next=23;break}return a.next=22,n.getFolders(e,++i);case 22:return a.abrupt("return",a.sent);case 23:case"end":return a.stop()}}),a,null,[[3,10]])})))()},loadTokens:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData(q.tokensPath);case 2:n=t.sent,W.dispatch("updateAccessTokens",n);case 4:case"end":return t.stop()}}),t)})))()},saveTokens:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=W.state.accessTokens,t.next=3,e.saveData(q.tokensPath,n);case 3:case"end":return t.stop()}}),t)})))()},loadSettings:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData(q.settingsPath);case 2:n=t.sent,a=(null===n||void 0===n?void 0:n.widgetList)||[],W.dispatch("updateUserWidgets",a);case 5:case"end":return t.stop()}}),t)})))()},saveSettings:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={widgetList:W.state.userWidgets},t.next=3,e.saveData(q.settingsPath,n);case 3:case"end":return t.stop()}}),t)})))()},reloadAll:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadUserInfo();case 2:return t.next=4,e.loadTokens();case 4:return t.next=6,e.loadSettings();case 6:case"end":return t.stop()}}),t)})))()}},G=a["default"].extend({name:"DropboxSignIn",data:function(){return{doRememberMe:!1}},computed:{isSignedIn:function(){return this.$store.getters.db_isLoggedIn},userShortName:function(){return this.$store.state.dropbox.db_userInfo.name.familiar_name},userFullName:function(){return this.$store.state.dropbox.db_userInfo.name.display_name},imgLink:function(){return this.$store.state.dropbox.db_userInfo.profile_photo_url}},methods:{openModal:function(){this.$bvModal.show("loginModal")},closeModal:function(){this.$bvModal.hide("loginModal")},signOut:function(){F.disconnectAccount(),this.closeModal()},openSignInScreen:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F.authorizeWithDropbox(e.doRememberMe);case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))()}}}),Q=G,J=(n("7600"),n("2877")),Y=Object(J["a"])(Q,l,u,!1,null,"1fa56000",null),K=Y.exports,Z=a["default"].extend({components:{DropboxSignIn:K},name:"Header",data:function(){return{}}}),X=Z,ee=Object(J["a"])(X,o,c,!1,null,null,null),te=ee.exports,ne=a["default"].extend({name:"App",components:{AppHeader:te},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.dispatch("updateIsLoading",!0),t.next=3,e.initializeDropbox();case 3:e.$store.dispatch("updateIsLoading",!1);case 4:case"end":return t.stop()}}),t)})))()},methods:{initializeDropbox:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tryHandleOauthRedirect();case 2:if(n=t.sent,n){t.next=6;break}return t.next=6,F.tryRefreshAccessToken();case 6:if(!e.$store.state.dropbox.db_accessToken){t.next=11;break}return t.next=9,F.reloadAll();case 9:t.next=13;break;case 11:a=["wanikani","test"],e.$store.dispatch("updateUserWidgets",a);case 13:case"end":return t.stop()}}),t)})))()},tryHandleOauthRedirect:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=new URLSearchParams(window.location.search),a=n.get("code"),i=e.$cookies.get("code_verifier"),e.$cookies.remove("code_verifier"),null===a||null===i){t.next=8;break}return t.next=7,F.handleDropboxOAuthRedirect(a,i);case 7:return t.abrupt("return",!0);case 8:return t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t)})))()}}}),ae=ne,ie=(n("034f"),Object(J["a"])(ae,i,s,!1,null,null,null)),se=ie.exports,re=n("8c4f"),oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("scroll-to-refresh",{attrs:{"is-loading":e.isLoading},on:{refresh:e.handleRefresh}}),a("img",{staticStyle:{margin:"50px 0 30px","max-width":"200px"},attrs:{src:n("3cd8"),alt:"bushu314 logo"}}),a("widget-list",{attrs:{refreshTrigger:e.refreshKey}})],1)},ce=[],le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["refresh-div",{refreshing:e.isLoading}],attrs:{id:"refreshDiv"}},[n("div",{class:{refreshing:e.isLoading},attrs:{id:"expander"}},[n("loading-icon",{class:["loading-icon",{refreshing:e.isLoading}],attrs:{"is-loading":e.isLoading,"height-px":e.isLoading?80:50}})],1),e.showManualTrigger&&!e.isLoading?n("div",{attrs:{id:"trigger"}},[n("b-button",{attrs:{size:"sm",pill:"",variant:"outline-danger"},on:{click:e.triggerRefresh}},[e._v(" Refresh ")])],1):e._e()])},ue=[],de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"svg-wrapper"}},[n("svg",{attrs:{viewBox:"0 0 "+e.viewboxWidthPx+" "+e.viewboxHeightPx,xmlns:"http://www.w3.org/2000/svg"}},[n("rect",{attrs:{x:"0",y:"0",width:e.viewboxWidthPx,height:e.viewboxHeightPx,stroke:"none",fill:e.boxColor,rx:"2.5"}}),n("g",{attrs:{fill:"none","stroke-width":"1","stroke-linejoin":"round","stroke-linecap":"round"}},[n("path",{attrs:{d:e.iconPath,"stroke-dasharray":e.pathLength,stroke:e.pathColor}}),n("path",{attrs:{d:e.iconPath,"stroke-dasharray":"16 16",stroke:e.loadingColorA}},[n("animate",{attrs:{attributeName:"stroke-dashoffset",values:"16; 48",begin:"0s",dur:"2s",repeatCount:"indefinite"}})]),n("path",{attrs:{d:e.iconPath,stroke:e.loadingColorB,"stroke-dasharray":"16 16"}},[n("animate",{attrs:{attributeName:"stroke-dashoffset",values:"0; -32",begin:"0s",dur:"2s",repeatCount:"indefinite"}})])])]),e.isLoading?e._e():n("svg",{attrs:{viewBox:"0 0 "+e.viewboxWidthPx+" "+e.viewboxHeightPx,xmlns:"http://www.w3.org/2000/svg"}},[n("defs",[n("linearGradient",{attrs:{id:"myGradient",gradientTransform:"rotate(90)"}},[n("stop",{attrs:{offset:"5%","stop-color":"gold"}}),n("stop",{attrs:{offset:"95%","stop-color":"red"}})],1)],1),n("path",{attrs:{d:e.iconPath,fill:"none",stroke:"url('#myGradient')","stroke-width":"1","stroke-linejoin":"round","stroke-linecap":"round"}},[n("animate",{staticClass:"end-animate",attrs:{attributeName:"stroke-dasharray",values:"0 32; 32 0",begin:"0s",dur:"0.3s"}}),n("animate",{staticClass:"end-animate",attrs:{attributeName:"stroke-dashoffset",values:"0; 16",begin:"0s",dur:"0.3s"}})])])])},he=[],me=(n("a9e3"),a["default"].extend({name:"LoadingIcon",props:{isLoading:{type:Boolean,required:!1,default:!0},heightPx:{type:Number,required:!0}},data:function(){return{iconPath:"\n        M 2.5 6.5\n        l 0 4\n        l 5 0\n        l 0 -1\n        l -3 -3\n        l -1.757359313 0\n        l 1.757359313 0\n        l 3 -3\n        l 0 -1\n        l -5 0\n        z\n      ",pathLength:32,boxColor:"#043",pathColor:"#dfe7",loadingColorA:"#fd8a",loadingColorB:"#8dfa",viewboxHeightPx:13,viewboxWidthPx:10}}})),pe=me,fe=(n("0cad"),Object(J["a"])(pe,de,he,!1,null,"2d80d57c",null)),ve=fe.exports,ge=a["default"].extend({name:"ScrollToRefresh",components:{LoadingIcon:ve},props:{isLoading:{type:Boolean,required:!1,default:!1}},data:function(){return{doRefresh:!1,showManualTrigger:!1}},created:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},watch:{doRefresh:function(){this.doRefresh&&this.triggerRefresh()}},methods:{handleScroll:function(){this.doRefresh=!this.isLoading&&window.scrollY<-70},triggerRefresh:function(){var e=Date.now().toString();this.$emit("refresh",e)}}}),be=ge,we=(n("0747"),Object(J["a"])(be,le,ue,!1,null,"67985f0a",null)),ye=we.exports,xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"all-widgets"},[e.$store.state.isLoading?n("b-spinner",{attrs:{variant:"secondary"}}):[e._l(e.displayedWidgets,(function(t,a){return["wanikani"===t.id?n("wanikani-widget",{key:"wanikani"+a+e.refreshTrigger}):e._e(),"test"===t.id?n("basic-widget",{key:"test"+a+e.refreshTrigger,scopedSlots:e._u([{key:"header",fn:function(){return[e._v(" Test Widget "+e._s(a)+" ")]},proxy:!0}],null,!0)},[n("div",[e._v(" test content a ")]),n("div",[e._v(" test content b ")]),n("b-button",[e._v("Test Button")])],1):e._e(),"test2"===t.id?n("basic-widget",{key:"test2"+a+e.refreshTrigger,scopedSlots:e._u([{key:"header",fn:function(){return[e._v(" Other Test Widget "+e._s(a)+" ")]},proxy:!0}],null,!0)},[n("div",[e._v(" test content ba ")]),n("div",[e._v(" test content bb ")]),n("div",[e._v(" test content bc ")]),n("b-button",[e._v("Test Button #2")])],1):e._e()]}))],n("div",{staticStyle:{margin:"5px 0 0"}},[n("hover-icon",{attrs:{icon:"gear",scale:"1.5",variant:"secondary"},on:{click:function(t){return e.openModal()}}})],1),n("b-modal",{attrs:{id:"settingsModal",title:"Edit Widget Layout",size:"lg",centered:"","hide-footer":""},on:{hidden:function(t){return e.onModalClose()}}},[n("b-row",{staticStyle:{"margin-bottom":"10px"}},[n("b-col",{attrs:{sm:"7"}},[n("small",[e._v("Displayed Widgets:")]),n("div",e._l(e.displayedWidgets,(function(t,a){return n("div",{key:a,staticClass:"displayed-widget-list-item"},[n("div",[n("h3",[e._v(e._s(t.name))]),n("small",[e._v(e._s(t.description))])]),n("div",[n("hover-icon",{attrs:{icon:"trash",scale:"1.5",variant:"danger"},on:{click:function(t){return e.removeWidget(a)}}})],1)])})),0)]),n("b-col",[n("small",[e._v("All Widgets:")]),n("b-card",{attrs:{"no-body":""}},[n("b-list-group",{attrs:{flush:""}},e._l(e.allWidgets,(function(t,a){return n("b-list-group-item",{key:t.id,staticClass:"d-flex justify-content-between align-items-center"},[n("div",{staticStyle:{display:"inline-block"}},[n("h5",[e._v(e._s(t.name))]),n("small",[e._v(e._s(t.description))])]),n("hover-icon",{attrs:{icon:"plus-circle",scale:"1.5",variant:"primary"},on:{click:function(t){return e.addWidget(a)}}})],1)})),1)],1)],1)],1),n("b-row",[n("b-col",{attrs:{sm:"4"}},[n("b-button",{staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{variant:"outline-danger"},on:{click:function(t){return e.undoChanges()}}},[e._v(" Cancel ")])],1),n("b-col",[n("b-button",{staticStyle:{width:"100%"},attrs:{variant:"outline-secondary"},on:{click:function(t){return e.closeModal()}}},[e._v(" Done ")])],1)],1)],1)],2)},Se=[],ke=(n("4de4"),n("a434"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("basic-widget",{scopedSlots:e._u([{key:"header",fn:function(){return[n("a",{attrs:{href:"https://www.wanikani.com",target:"_blank"}},[n("img",{staticStyle:{height:"30px"},attrs:{src:"https://assets.wanikani.com/assets/logo--retro-colors-9b88dd59.png"}})])]},proxy:!0},{key:"dropdown-items",fn:function(){return[n("b-dropdown-item",{on:{click:function(t){return e.openLoginModal()}}},[e._v("Update access token")]),n("b-dropdown-item",{attrs:{disabled:""},on:{click:function(t){return e.openKTListModal()}}},[e._v("Export Kanji Teacher list (WIP)")])]},proxy:!0}])},[e.loading?n("div",[n("b-spinner")],1):e.isConnected?n("div",{staticClass:"body-section"},[n("div",{staticClass:"widget-section"},[n("h5",[e._v("Level "+e._s(e.userLevel))]),n("a",{attrs:{href:"https://www.wanikani.com/lesson",target:"_blank"}},[n("div",{staticClass:"clickable-item kanji-color"},[e._v(" Lessons: "+e._s(e.lessonCount)+" ")])]),n("a",{attrs:{href:"https://www.wanikani.com/review",target:"_blank"}},[n("div",{staticClass:"clickable-item radical-color"},[e._v(" Reviews: "+e._s(e.reviewCount)+" ")])])]),e.todaysLessons.length>0?n("div",{staticClass:"widget-section"},[n("h5",[e._v("Today's Lessons")]),n("div",{staticStyle:{margin:"auto","max-width":"300px"}},e._l(e.todaysLessons,(function(t,a){return n("a",{key:a,attrs:{href:t.data.document_url,target:"_blank"}},[n("div",{class:["clickable-item","today-lesson",{"radical-color":"radical"===t.object,"kanji-color":"kanji"===t.object,"vocab-color":"vocabulary"===t.object||"kana_vocabulary"===t.object}],attrs:{title:e.getSubjectMeaning(t)}},[e._v(" "+e._s(t.data.characters)+" ")])])})),0)]):e._e()]):n("div",{staticClass:"widget-section"},[e._v(" Could not connect to WaniKani account. "),n("div",{staticStyle:{margin:"10px 0"}},[n("b-button",{attrs:{size:"sm"},on:{click:function(t){return e.openLoginModal()}}},[e._v(" Update access token ")])],1)]),n("b-modal",{attrs:{id:"wk_accessTokenModal",title:"Update Access Token",centered:"","ok-variant":"success","ok-title":"Save","cancel-variant":"outline-danger"},on:{ok:function(t){return e.saveTokenUpdate()},cancel:function(t){return e.cancelTokenUpdate()},hidden:function(t){return e.onLoginModalClose()}}},[e._v(" Edit access token for your WaniKani account: "),n("b-input-group",[n("b-form-input",{attrs:{type:"text"},model:{value:e.modeledTokenString,callback:function(t){e.modeledTokenString=t},expression:"modeledTokenString"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"warning"},on:{click:function(t){return e.testNewToken()}}},[e._v(" Test ")])],1)],1),e.newTokenResult?n("div",{class:["test-result-div",{"test-success":e.isNewTokenValid,"test-fail":!e.isNewTokenValid}]},[e._v(" "+e._s(e.newTokenResult)+" ")]):e._e()],1)],1)}),Ce=[],_e=(n("2b3d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"widget"},[n("div",{staticClass:"header"},[n("h3",[e._t("header")],2),n("b-dropdown",{staticStyle:{height:"25px","padding-left":"50px"},attrs:{right:"",variant:"transparent-secondary"}},[e._t("dropdown-items",(function(){return[n("b-dropdown-item",[e._v("Test item 1")]),n("b-dropdown-item",[e._v("Test item 2")])]}))],2)],1),n("div",{staticClass:"main-body"},[e._t("default")],2)])}),Ie=[],Te=a["default"].extend({name:"BasicWidget"}),Re=Te,ze=(n("80c2"),Object(J["a"])(Re,_e,Ie,!1,null,"a2c29ee6",null)),De=ze.exports,je=a["default"].extend({name:"WanikaniWidget",components:{BasicWidget:De},data:function(){return{loading:!1,isConnected:!1,userLevel:0,lessonCount:0,reviewCount:0,todaysLessons:[],ktListStartLevel:0,ktListEndLevel:0,ktListObject:null,modeledTokenString:"",newAccessToken:"",isNewTokenValid:!0,newTokenResult:""}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.apiAccessToken){t.next=7;break}return t.next=3,e.loadData();case 3:e.newAccessToken=e.apiAccessToken,e.modeledTokenString=e.apiAccessToken,e.ktListStartLevel=1,e.ktListEndLevel=e.userLevel;case 7:case"end":return t.stop()}}),t)})))()},watch:{apiAccessToken:function(){this.loadData()}},computed:{apiAccessToken:function(){var e;return this.$store.getters.db_isLoggedIn?(null===(e=this.$store.state.accessTokens)||void 0===e?void 0:e.wanikani)||"":this.newAccessToken||""},ktListBlob:function(){return URL.createObjectURL(new Blob([JSON.stringify(this.ktListObject,null,2)]))}},methods:{openLessons:function(){window.open("https://www.wanikani.com/lesson")},openReviews:function(){window.open("https://www.wanikani.com/review")},getSubjectMeaning:function(e){return e.data.meanings[0].meaning},loadData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.getUserData();case 4:return t.next=6,e.getSummary();case 6:return t.next=8,e.getTodaysLessons();case 8:e.isConnected=!0,t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](0),n=t.t0,e.isConnected=!1,console.error("Error loading data: "+n.message);case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,11,16,19]])})))()},testNewToken:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.a.get("https://api.wanikani.com/v2/user",{headers:{Authorization:"Bearer "+e.modeledTokenString}});case 3:n=t.sent,a=n.data.data,e.isNewTokenValid=!0,e.newTokenResult="Successfully connected to account for user "+a.username+"!",e.newAccessToken=e.modeledTokenString,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](0),i=t.t0,e.isNewTokenValid=!1,i.response&&401===i.response.status?e.newTokenResult="Invalid access token.":e.newTokenResult="Error while running test: "+i.message;case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},getUserData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.a.get("https://api.wanikani.com/v2/user",{headers:{Authorization:"Bearer "+e.apiAccessToken}});case 2:n=t.sent,e.userLevel=n.data.data.level;case 4:case"end":return t.stop()}}),t)})))()},getSummary:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.a.get("https://api.wanikani.com/v2/summary",{headers:{Authorization:"Bearer "+e.apiAccessToken},params:{t:Date.now()}});case 2:n=t.sent,e.lessonCount=n.data.data.lessons[0].subject_ids.length,e.reviewCount=n.data.data.reviews[0].subject_ids.length;case 5:case"end":return t.stop()}}),t)})))()},getTodaysLessons:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new Date,n.setHours(0,0,0,0),a=n.toISOString(),i="https://api.wanikani.com/v2/assignments"+"?updated_after=".concat(a)+"&srs_stages=1,2,3",s=function(e){return!!e.data.started_at&&new Date(e.data.started_at)>=n},t.next=7,e.getSubjectsByAssignmentsUrl(i,s);case 7:e.todaysLessons=t.sent;case 8:case"end":return t.stop()}}),t)})))()},saveTokenUpdate:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.newAccessToken=e.modeledTokenString,n={key:"wanikani",value:e.newAccessToken},e.$store.dispatch("updateSingleAccessToken",n),!e.$store.getters.db_isLoggedIn){t.next=6;break}return t.next=6,F.saveTokens();case 6:e.closeLoginModal();case 7:case"end":return t.stop()}}),t)})))()},cancelTokenUpdate:function(){this.modeledTokenString=this.apiAccessToken,this.closeLoginModal()},openLoginModal:function(){this.$bvModal.show("wk_accessTokenModal")},closeLoginModal:function(){this.$bvModal.hide("wk_accessTokenModal")},onLoginModalClose:function(){this.newTokenResult=""},openKTListModal:function(){},getPaginatedResourceData:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=[];case 1:if(null===e){n.next=10;break}return n.next=4,h.a.get(e,{headers:{Authorization:"Bearer "+t.apiAccessToken}});case 4:i=n.sent,s=i.data,e=s.pages.next_url,a=a.concat(s.data),n.next=1;break;case 10:return n.abrupt("return",a);case 11:case"end":return n.stop()}}),n)})))()},getSubjectsByAssignmentsUrl:function(e){var t=arguments,n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s,r,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:function(){return!0},a.next=3,n.getPaginatedResourceData(e);case 3:return s=a.sent,r=s.filter(i).map((function(e){return e.data.subject_id})),o="https://api.wanikani.com/v2/subjects?ids="+r.join(),a.next=8,n.getPaginatedResourceData(o);case 8:return c=a.sent,a.abrupt("return",c);case 10:case"end":return a.stop()}}),a)})))()}}}),Le=je,Ee=(n("caf0"),Object(J["a"])(Le,ke,Ce,!1,null,"7f873998",null)),Me=Ee.exports,Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:e.icon+e.getSuffix(),"font-scale":e.scale?e.scale:"1",variant:e.variant},on:{mouseenter:function(t){e.isHovering=!0},mouseleave:function(t){e.isHovering=!1},click:function(t){return e.$emit("click")}}})},Ae=[],Pe=(n("fb6a"),a["default"].extend({props:{icon:String,scale:String,variant:String},name:"HoverIcon",data:function(){return{isHovering:!1}},methods:{getSuffix:function(){return this.isHovering&&"-fill"!==this.icon.slice(-5)?"-fill":""}}})),Ve=Pe,$e=Object(J["a"])(Ve,Oe,Ae,!1,null,null,null),We=$e.exports,Ne=a["default"].extend({name:"WidgetList",props:{refreshTrigger:String},components:{wanikaniWidget:Me,basicWidget:De,hoverIcon:We},data:function(){return{allWidgets:[{id:"wanikani",name:"WaniKani",description:"Do your reviews!"},{id:"test",name:"Test Widget",description:"Don't have enough widgets defined yet so here's just a sample"},{id:"test2",name:"Test Widget 2",description:"Another sample widget. Doesn't do much"}],displayedWidgets:[]}},watch:{"$store.state.userWidgets":function(){this.syncWithStore()}},created:function(){this.syncWithStore()},methods:{syncWithStore:function(){var e=this;this.displayedWidgets=this.$store.state.userWidgets.map((function(t){return e.allWidgets.find((function(e){return e.id===t}))})).filter((function(e){return void 0!==e}))},addWidget:function(e){this.displayedWidgets.push(this.allWidgets[e])},removeWidget:function(e){this.displayedWidgets.splice(e,1)},undoChanges:function(){this.syncWithStore(),this.closeModal()},openModal:function(){this.$bvModal.show("settingsModal")},closeModal:function(){this.$bvModal.hide("settingsModal")},onModalClose:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.dispatch("updateUserWidgets",e.displayedWidgets.map((function(e){return e.id}))),t.next=3,F.saveSettings();case 3:case"end":return t.stop()}}),t)})))()}}}),Be=Ne,Ue=(n("defd"),Object(J["a"])(Be,xe,Se,!1,null,"c941bd92",null)),qe=Ue.exports,He=a["default"].extend({name:"Home",components:{widgetList:qe,scrollToRefresh:ye},data:function(){return{doRefresh:!1,refreshKey:"",isLoading:!1}},methods:{handleRefresh:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.isLoading=!0,t.refreshKey=e,n.next=4,F.reloadAll();case 4:t.isLoading=!1;case 5:case"end":return n.stop()}}),n)})))()}}}),Fe=He,Ge=Object(J["a"])(Fe,oe,ce,!1,null,null,null),Qe=Ge.exports,Je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("scroll-to-refresh",{attrs:{"is-loading":e.isLoading},on:{refresh:e.handleRefresh}}),e.watchlist?n("div",{attrs:{id:"all-sections-container"}},[n("div",{attrs:{id:"buttons-container"}},[n("icon-button",{attrs:{icon:"collection"},on:{click:function(t){return e.openCatalog()}}})],1),n("div",{attrs:{id:"active-sections-container"}},[n("div",{attrs:{id:"currently-watching-section"}},[e._v(" Currently Watching ")]),n("div",{attrs:{id:"main-live-container"}},[n("div",{attrs:{id:"main-list"}},[n("watchlist-section",{attrs:{"list-type":"main"},on:{"add-item":function(t){return e.selectCatalogEntry("main")},"mark-item-completed":e.showMarkCompletedOptions,"demote-item":e.demoteItem,"remove-item":e.promptConfirmRemoveItem},model:{value:e.watchlist.main,callback:function(t){e.$set(e.watchlist,"main",t)},expression:"watchlist.main"}})],1),n("div",{attrs:{id:"live-list"}},[n("watchlist-section",{attrs:{"list-type":"live"},on:{"add-item":function(t){return e.selectCatalogEntry("live")},"mark-item-completed":e.showMarkCompletedOptions,"promote-item":e.promoteItem,"demote-item":e.demoteItem,"remove-item":e.promptConfirmRemoveItem,"irregular-seasons-updated":function(t){return e.loadWatchlist()}},model:{value:e.watchlist.live,callback:function(t){e.$set(e.watchlist,"live",t)},expression:"watchlist.live"}})],1)])]),n("div",{attrs:{id:"inactive-sections-container"}},[n("div",{attrs:{id:"queue-list"}},[n("watchlist-section",{attrs:{"list-type":"queue"},on:{"add-item":function(t){return e.selectCatalogEntry("queue")},"promote-item":e.promoteItem,"remove-item":e.promptConfirmRemoveItem,reorder:e.onReorderList},model:{value:e.watchlist.queue,callback:function(t){e.$set(e.watchlist,"queue",t)},expression:"watchlist.queue"}})],1),n("div",{attrs:{id:"upcoming-list"}},[n("watchlist-section",{attrs:{"list-type":"upcoming"},on:{"add-item":function(t){return e.selectCatalogEntry("upcoming")},"promote-item":e.promoteItem,"remove-item":e.promptConfirmRemoveItem,"irregular-seasons-updated":function(t){return e.loadWatchlist()}},model:{value:e.watchlist.upcoming,callback:function(t){e.$set(e.watchlist,"upcoming",t)},expression:"watchlist.upcoming"}})],1),n("div",{attrs:{id:"backlog-list"}},[n("watchlist-section",{attrs:{"list-type":"backlog"},on:{"add-item":function(t){return e.selectCatalogEntry("backlog")},"promote-item":e.promoteItem,"remove-item":e.promptConfirmRemoveItem,reorder:e.onReorderList},model:{value:e.watchlist.backlog,callback:function(t){e.$set(e.watchlist,"backlog",t)},expression:"watchlist.backlog"}})],1)])]):e._e(),n("catalog-modal",{attrs:{id:"catalogModal","selection-target-list":e.targetListName},on:{"item-selected":e.addCatalogItemToList,hidden:function(t){return e.resetTargets()}}}),n("b-modal",{attrs:{id:"markCompletedModal",title:"Marking Season Completed",size:"md",centered:"","ok-title":"Confirm"},on:{ok:e.markSeasonCompleted,hide:e.onModalHide}},[n("watchlist-item",{attrs:{"parent-list":"main","season-view":e.targetSeasonView,"is-read-only":!0}}),n("ul",{attrs:{id:"mark-completed-options"}},[e.targetShowSeason?n("li",{class:{selected:e.doNextSeasonToQueue},on:{click:function(t){t.preventDefault(),e.doNextSeasonToQueue=!e.doNextSeasonToQueue}}},[n("b-form-checkbox",{model:{value:e.doNextSeasonToQueue,callback:function(t){e.doNextSeasonToQueue=t},expression:"doNextSeasonToQueue"}},[e._v(" Add next season to Queue: ")]),n("watchlist-item",{attrs:{"show-season":e.targetShowSeason,"is-read-only":!0}})],1):e._e(),e.targetNextQueueItem?n("li",{class:{selected:e.doPopQueueToMain},on:{click:function(t){t.preventDefault(),e.doPopQueueToMain=!e.doPopQueueToMain}}},[n("b-form-checkbox",{model:{value:e.doPopQueueToMain,callback:function(t){e.doPopQueueToMain=t},expression:"doPopQueueToMain"}},[e._v(" Move next item from Queue to Main: ")]),n("watchlist-item",{attrs:{"season-view":e.targetNextQueueItem,"is-read-only":!0}})],1):e._e()])],1),n("b-modal",{attrs:{id:"confirmRemoveModal",title:"Drop "+("backlog"===e.targetListName?"show":"season")+"?",size:"md",centered:"","ok-title":"Confirm","ok-variant":"danger"},on:{ok:e.removeItem,hide:e.onModalHide}},[n("watchlist-item",{attrs:{"parent-list":e.targetListName,"season-view":e.targetSeasonView,"show-season":e.targetShowSeason,"show-info":e.targetShowInfo,"is-read-only":!0}}),e._v(" The season will be "+e._s(e.targetSeasonView?"marked as Dropped and":"")+" removed from "+e._s("queue"===e.targetListName||"backlog"===e.targetListName?"the ":"")+e._s(e._f("toTitleCase")(e.targetListName))+". ")],1)],1)},Ye=[],Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",e._b({attrs:{title:e.selectMode?"Select a "+e.selectMode+":":"Catalog",centered:"",scrollable:""},on:{hidden:function(t){return e.onModalClose()}},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var a=t.ok;return[n("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between"}},[n("b-button",{staticStyle:{padding:"6px",border:"none","line-height":"20px"},attrs:{variant:"secondary"},on:{click:function(t){return e.createNewEntry()}}},[n("b-icon",{attrs:{icon:"plus",variant:"light","font-scale":"1.5"}})],1),e.selectionTargetList?n("b-button",{attrs:{size:"sm",variant:"outline-primary",disabled:!e.selectedItemId},on:{click:function(t){return e.chooseItem()}}},[e._v(" Select "+e._s(e._f("toTitleCase")(e.selectMode))+" ")]):e._e(),n("b-button",{attrs:{size:"sm",variant:"outline-success"},on:{click:function(e){return a()}}},[e._v(" "+e._s(e.selectionTargetList?"Cancel":"Close")+" ")])],1)]}}])},"b-modal",e.$attrs,!1),[n("div",{attrs:{id:"catalog-search"}},[n("b-form-input",{attrs:{type:"search",debounce:"350",placeholder:"Search"},on:{update:e.searchTMDB},model:{value:e.searchString,callback:function(t){e.searchString=t},expression:"searchString"}})],1),e.catalog&&0!==e.catalog.length?e._e():n("div",[e._v(" There are no items in the catalog. ")]),e._l(e.filteredCatalog,(function(t,a){return n("div",{key:a,staticClass:"show-entry"},[n("div",{class:["show-info",{"selected-item":t.id===e.selectedItemId}],on:{click:function(n){return e.selectShow(t.id)}}},[n("div",{staticStyle:{display:"flex",width:"100%"}},[n("thumbnail-image",{staticStyle:{"margin-right":"10px"},attrs:{link:e.getShowImageLink(t),colorSeed:t.id,height:90}}),n("div",{staticClass:"show-details"},[n("div",[n("h4",[e._v(e._s(t.title))]),t.altTitle?n("div",{staticClass:"alt-title"},[e._v(" "+e._s(t.altTitle)+" ")]):e._e()]),t.seasonCount?n("div",[e._v(" "+e._s(e.tools.pluralFormat(t.seasonCount,"season"))+" ")]):n("div",[e._v(" "+e._s(e.getTotalEpisodeCount(t))+" total episodes ")])])],1),n("div",{staticClass:"show-icons"},[n("div",{staticStyle:{"font-size":"1.5em","font-weight":"bold","text-align":"center"}},[e._v(" "+e._s(t.isAnime?"ア":" ")+" ")]),n("div",{on:{click:function(t){return t.stopPropagation(),e.editShowEntry(a)}}},[n("hover-icon",{attrs:{icon:"pencil",scale:"1.75",variant:"secondary"}})],1),"show"!==e.selectMode?n("hover-icon",{style:"transition: transform 0.2s;"+(e.expandedShowId===t.id?"transform: rotate(90deg)":""),attrs:{icon:"caret-right"+(e.expandedShowId===t.id?"-fill":""),scale:"1.75",variant:"secondary"}}):e._e()],1)]),n("b-collapse",{attrs:{id:t.id,accordion:"show-accordion"}},[n("div",{staticClass:"seasons-section"},e._l(t.seasons,(function(i,s){return n("div",{key:a+"-"+s,class:["show-info","show-season",{"selected-item":i.id===e.selectedItemId}],on:{click:function(t){return e.selectSeason(i.id)}}},[n("div",{staticStyle:{display:"flex",width:"100%"}},[t.seasons.some((function(e){return e.imgLink}))?n("thumbnail-image",{staticStyle:{"margin-right":"10px"},attrs:{link:e.getSeasonImageLink(t,s),doFaded:!i.imgLink,colorSeed:i.id,height:80}}):e._e(),n("div",{staticClass:"season-details"},[n("h5",[e._v(" "+e._s("Season "+i.seasonNumber+(i.name?": "+i.name:""))+" ")]),n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-end"}},[n("div",[i.totalEpisodeCount?n("div",[e._v(" "+e._s(e.tools.pluralFormat(i.totalEpisodeCount,"episode"))+" ")]):e._e(),i.startDate||i.endDate?n("div",[e._v(" Aired "+e._s(e._f("formatDate")(i.startDate))+" "),i.startDate!==i.endDate?n("span",[e._v(" - "+e._s(e._f("formatDate")(i.endDate))+" ")]):e._e()]):e._e()]),i.airingYear&&i.airingSeason?n("div",[n("b",[e._v(e._s(i.airingYear+" "+i.airingSeason))])]):e._e()])])],1)])})),0)])],1)})),e.tmdbShowResults.length>0?n("div",{attrs:{id:"tmdb-results"}},[n("h3",[e._v(" Add from "),n("div",{staticStyle:{display:"inline-flex"}},[n("img",{staticStyle:{height:"24px"},attrs:{src:"https://www.themoviedb.org/assets/2/v4/logos/v2/blue_short-8e7b30f73a4020692ccca9c88bafe5dcb6f8a62a4c6bc55cd9ba82bb2cd95f6c.svg"}})])]),n("div",{staticStyle:{margin:"-8px 0 8px","font-size":"7.75px",color:"#666"}},[e._v(" BushuApp uses TMDB and the TMDB APIs but is not endorsed, certified, or otherwise approved by TMDB. ")]),e._l(e.tmdbShowResults,(function(t){return n("div",{key:t.id,staticClass:"tmdb-show"},[n("thumbnail-image",{attrs:{link:t.imgLink,height:75,colorSeed:"0d253f"}}),n("div",{staticClass:"tmdb-show-text"},[n("div",[e._v(e._s(t.title))]),t.altTitle?n("div",[e._v(" "+e._s(t.altTitle)+" ")]):e._e()])],1)}))],2):e._e()],2),n("show-info-edit-modal",{attrs:{id:"editModal",isNewShow:""===e.editingShowId},on:{"save-changes":e.saveShowEntry},model:{value:e.editingShowInfo,callback:function(t){e.editingShowInfo=t},expression:"editingShowInfo"}})],1)},Ze=[],Xe=(n("caad"),n("2532"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",e._b({attrs:{title:e.modalTitle,centered:"",scrollable:""},on:{show:function(t){return e.loadValue()}},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[n("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between"}},[n("b-button",{staticStyle:{width:"30%"},on:{click:function(t){return e.closeModal()}}},[e._v(" Cancel ")]),n("b-button",{staticStyle:{width:"60%"},attrs:{variant:"outline-success",disabled:!e.isChanged},on:{click:function(t){return e.checkValidity()}}},[e._v(" Save ")])],1)]},proxy:!0}])},"b-modal",e.$attrs,!1),[n("div",[n("b-form",{attrs:{id:"show-info-form"}},[n("div",{staticClass:"show-entry"},[n("div",{staticClass:"show-info"},[n("b-container",[n("b-form-row",[n("b-col",{attrs:{cols:"4"}},[n("label",{attrs:{for:"form-title"}},[e._v("Title:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-title",type:"text",required:""},model:{value:e.showData.title,callback:function(t){e.$set(e.showData,"title",t)},expression:"showData.title"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"4"}},[n("label",{attrs:{for:"form-alt-title"}},[e._v("Alt title:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-alt-title",type:"text"},model:{value:e.showData.altTitle,callback:function(t){e.$set(e.showData,"altTitle",t)},expression:"showData.altTitle"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"4"}},[n("label",{attrs:{for:"form-season-count"}},[e._v("Total seasons:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-season-count",type:"number"},model:{value:e.showData.seasonCount,callback:function(t){e.$set(e.showData,"seasonCount",e._n(t))},expression:"showData.seasonCount"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"4"}},[n("label",{attrs:{for:"form-img-link"}},[e._v("Image link:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-img-link",type:"text"},model:{value:e.showData.imgLink,callback:function(t){e.$set(e.showData,"imgLink",t)},expression:"showData.imgLink"}})],1)],1),n("b-row",[n("b-col",[n("b-form-row",[n("b-col",{attrs:{cols:"5"}},[n("label",{attrs:{for:"form-anime"}},[e._v("Anime?")])]),n("b-col",{attrs:{cols:"*"}},[n("b-form-checkbox",{attrs:{id:"form-anime",switch:""},model:{value:e.showData.isAnime,callback:function(t){e.$set(e.showData,"isAnime",t)},expression:"showData.isAnime"}})],1)],1),e.showData.isAnime?n("b-form-row",[n("b-col",{attrs:{cols:"*"}},[n("label",{attrs:{for:"form-show-episode-count"}},[e._v("Count total episodes?")])]),n("b-col",{attrs:{cols:"*"}},[n("b-form-checkbox",{attrs:{id:"form-show-episode-count",switch:""},model:{value:e.showData.doEpisodeCountOverall,callback:function(t){e.$set(e.showData,"doEpisodeCountOverall",t)},expression:"showData.doEpisodeCountOverall"}})],1)],1):e._e()],1),n("b-col",{style:e.showData.imgLink?"":"visibility: hidden",attrs:{cols:"*"}},[n("div",{staticClass:"thumbnail-sample season-color"},[n("thumbnail-image",{attrs:{link:e.showData.imgLink,colorSeed:e.showData.id,height:64}})],1)])],1)],1)],1),n("div",{staticClass:"seasons-section"},[e._l(e.showData.seasons,(function(t,a){return n("div",{key:a,staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"}},[n("div",{staticClass:"delete-button",on:{click:function(t){return e.deleteSeason(a)}}},[n("b-icon",{attrs:{icon:"trash"}})],1),n("div",{staticClass:"show-season-edit"},[n("b-container",[n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-number"}},[e._v("Season #:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-szn-"+a+"-number",type:"number",step:"0.1",required:""},model:{value:t.seasonNumber,callback:function(n){e.$set(t,"seasonNumber",e._n(n))},expression:"season.seasonNumber"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-name"}},[e._v("Season name:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-szn-"+a+"-name",type:"text"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"season.name"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-episode-count"}},[e._v("Episode count:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-szn-"+a+"-episode-count",type:"number"},model:{value:t.totalEpisodeCount,callback:function(n){e.$set(t,"totalEpisodeCount",e._n(n))},expression:"season.totalEpisodeCount"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-start-date"}},[e._v("Start date:")])]),n("b-col",[n("b-datepicker",{attrs:{id:"form-szn-"+a+"-start-date","show-decade-nav":"","label-help":""},model:{value:t.startDate,callback:function(n){e.$set(t,"startDate",n)},expression:"season.startDate"}})],1)],1),n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-end-date"}},[e._v("End date:")])]),n("b-col",[n("b-datepicker",{attrs:{id:"form-szn-"+a+"-end-date","show-decade-nav":"","label-help":""},model:{value:t.endDate,callback:function(n){e.$set(t,"endDate",n)},expression:"season.endDate"}})],1)],1),e.showData.isAnime?n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-airing-szn"}},[e._v("Season aired:")])]),n("b-col",{attrs:{cols:"6"}},[n("b-form-radio-group",{attrs:{id:"form-szn-"+a+"-airing-szn",options:["冬","春","夏","秋"],buttons:"",size:"sm"},model:{value:t.airingSeason,callback:function(n){e.$set(t,"airingSeason",n)},expression:"season.airingSeason"}})],1),n("b-col",{attrs:{cols:"3"}},[n("b-form-input",{attrs:{id:"form-szn-"+a+"-airing-year",type:"number"},model:{value:t.airingYear,callback:function(n){e.$set(t,"airingYear",e._n(n))},expression:"season.airingYear"}})],1)],1):e._e(),n("b-form-row",[n("b-col",{attrs:{cols:"3"}},[n("label",{attrs:{for:"form-szn-"+a+"-img-link"}},[e._v("Image link:")])]),n("b-col",[n("b-form-input",{attrs:{id:"form-szn-"+a+"-img-link",type:"text"},model:{value:t.imgLink,callback:function(n){e.$set(t,"imgLink",n)},expression:"season.imgLink"}})],1)],1),t.imgLink?n("div",{staticClass:"thumbnail-sample show-color"},[n("thumbnail-image",{attrs:{link:t.imgLink,colorSeed:t.id,height:64}})],1):e._e()],1)],1)])})),n("div",{staticClass:"add-season-button",on:{click:function(t){return e.addSeason()}}},[n("b-icon",{attrs:{icon:"plus","font-scale":"2",variant:"light"}})],1)],2)])])],1)])],1)}),et=[],tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.sizeStyle+e.colorStyle},[n("b-img-lazy",{style:e.sizeStyle+(e.doFaded?"opacity: 0.6;":"")+(e.link?"":"visibility: hidden;"),attrs:{src:e.link}})],1)},nt=[],at=a["default"].extend({name:"ThumbnailImage",props:{link:{type:String},colorSeed:{type:String,required:!1,default:""},height:{type:Number},doFaded:{type:Boolean,required:!1,default:!1}},computed:{sizeStyle:function(){return this.height?"height: ".concat(this.height,"px; width: ").concat(2*this.height/3,"px; min-width: ").concat(2*this.height/3,"px;"):""},colorStyle:function(){return this.colorSeed.length>=6?"background-color: #".concat(this.colorSeed.slice(-6),";"):"background-color: #6c757d;"}}}),it=at,st=Object(J["a"])(it,tt,nt,!1,null,null,null),rt=st.exports,ot=a["default"].extend({name:"ShowInfoEditModal",components:{thumbnailImage:rt},props:{value:{required:!0,type:Object},isNewShow:{required:!0,type:Boolean}},data:function(){return{showData:{},originalData:{}}},watch:{value:function(){this.loadValue()}},computed:{modalTitle:function(){return this.isNewShow?"Create New Show":"Edit Show Info"+(this.showData.title?": "+this.showData.title:"")},isChanged:function(){var e=this,t=this.showData.id!==this.originalData.id||this.showData.title!==this.originalData.title||this.showData.altTitle!==this.originalData.altTitle||this.showData.imgLink!==this.originalData.imgLink||this.showData.isAnime!==this.originalData.isAnime||this.showData.doEpisodeCountOverall!==this.originalData.doEpisodeCountOverall||this.showData.seasonCount!==this.originalData.seasonCount,n=!1;return this.showData.seasons&&this.originalData.seasons&&(n=this.showData.seasons.length!==this.originalData.seasons.length||this.showData.seasons.some((function(t,n){return t.id!==e.originalData.seasons[n].id||t.showId!==e.originalData.seasons[n].showId||t.seasonNumber!==e.originalData.seasons[n].seasonNumber||t.name!==e.originalData.seasons[n].name||t.totalEpisodeCount!==e.originalData.seasons[n].totalEpisodeCount||t.startDate!==e.originalData.seasons[n].startDate||t.endDate!==e.originalData.seasons[n].endDate||t.airingSeason!==e.originalData.seasons[n].airingSeason||t.airingYear!==e.originalData.seasons[n].airingYear||t.imgLink!==e.originalData.seasons[n].imgLink}))),t||n}},methods:{deleteSeason:function(e){this.showData.seasons.splice(e,1)},addSeason:function(){var e=0;this.showData.seasons.length>0&&(e=this.showData.seasons[this.showData.seasons.length-1].seasonNumber),this.showData.seasons.push({id:v.getGUID(),showId:this.showData.id,seasonNumber:Math.floor(e+1)})},loadValue:function(){this.showData=v.deepClone(this.value),this.originalData=v.deepClone(this.value)},syncModel:function(){this.$emit("input",this.showData)},checkValidity:function(){var e=document.getElementById("show-info-form"),t=e.reportValidity();t&&this.saveChanges()},saveChanges:function(){this.showData.seasons.sort((function(e,t){return e.seasonNumber-t.seasonNumber})),this.syncModel(),this.$emit("save-changes"),this.closeModal()},closeModal:function(){this.$bvModal.hide("editModal")}}}),ct=ot,lt=(n("deb7"),Object(J["a"])(ct,Xe,et,!1,null,"29c4afef",null)),ut=lt.exports,dt="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI3NmFmNWI3MzVlZmU3ZTkzOGI4MGJkMGY1OTg4YzAxZSIsIm5iZiI6MTcxOTc4MjYyOC4yNzM4NzcsInN1YiI6IjY2ODFjNmUyYWYzMzg4NzQyMGVmNDg4OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.4lJ_Smt237V-SToqhuMDGEGwmSLqM7Wb55fA0c5L7FI",ht="https://www.themoviedb.org/assets/2/v4/logos/v2/blue_square_2-d537fb228cf3ded904ef09b136fe3fec72548ebc1fea3fbbd1ad9e36364db38b.svg";function mt(){return"Bearer ".concat(dt)}function pt(e){return e?"https://image.tmdb.org/t/p/w342".concat(e):void 0}function ft(e){return null!==e&&void 0!==e?e:ht}function vt(e){return gt.apply(this,arguments)}function gt(){return gt=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,s,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],a="https://api.themoviedb.org/3/search/",a+=n?"movie":"tv",a+="?query=".concat(encodeURIComponent(t)),e.prev=4,e.next=7,h.a.get(a,{headers:{Authorization:mt(),accept:"application/json"}});case 7:return i=e.sent,e.abrupt("return",i.data);case 11:throw e.prev=11,e.t0=e["catch"](4),s=e.t0,s;case 15:case"end":return e.stop()}}),e,null,[[4,11]])}))),gt.apply(this,arguments)}var bt={searchTVShows:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,vt(e);case 2:return n=t.sent,t.abrupt("return",n.results.map((function(e){var t,n;return{id:e.id.toString(),title:e.name,altTitle:"en"!==e.original_language&&e.original_name?e.original_name:void 0,isAnime:(null===(t=e.origin_country)||void 0===t?void 0:t.includes("JP"))&&(null===(n=e.genre_ids)||void 0===n?void 0:n.includes(16)),imgLink:ft(pt(e.poster_path)),seasons:[]}})));case 4:case"end":return t.stop()}}),t)})))()}},wt=a["default"].extend({name:"CatalogModal",components:{showInfoEditModal:ut,hoverIcon:We,thumbnailImage:rt},props:{selectionTargetList:{type:String,required:!1}},data:function(){return{catalog:[],expandedShowId:"",editingShowInfo:{},editingShowId:"",selectedItemId:"",searchString:"",tmdbShowResults:[],tools:v}},computed:{isReady:function(){return!this.$store.state.watchlist.isLoading},selectMode:function(){return void 0==this.selectionTargetList?null:"backlog"===this.selectionTargetList?"show":"season"},filteredCatalog:function(){var e=this;return""===this.searchString?this.catalog:this.catalog.filter((function(t){return t.title.toLowerCase().includes(e.searchString.toLowerCase())}))}},watch:{isReady:function(e){e&&this.loadData()}},created:function(){var e=this;this.loadData(),this.$root.$on("bv::collapse::state",(function(t,n){n?e.expandedShowId=t:e.expandedShowId===t&&(e.expandedShowId="")}))},methods:{loadData:function(){this.isReady&&(this.catalog=this.$store.state.watchlist.catalog)},toggleShow:function(e){this.$root.$emit("bv::toggle::collapse",e)},selectShow:function(e){"show"===this.selectMode?this.selectedItemId=this.selectedItemId===e?"":e:this.toggleShow(e)},selectSeason:function(e){"season"===this.selectMode&&(this.selectedItemId=this.selectedItemId===e?"":e)},chooseItem:function(){var e=this;if("show"===this.selectMode){var t=this.catalog.find((function(t){return t.id===e.selectedItemId}));t&&this.$emit("item-selected",t,this.selectionTargetList)}else if("season"===this.selectMode)for(var n=0;n<this.catalog.length;n++)for(var a=this.catalog[n],i=0;i<a.seasons.length;i++)if(a.seasons[i].id===this.selectedItemId){var s=a.seasons[i];return void this.$emit("item-selected",s,this.selectionTargetList)}},getTotalEpisodeCount:function(e){return e.seasons.reduce((function(e,t){return e+(t.totalEpisodeCount?t.totalEpisodeCount:0)}),0)},getShowImageLink:function(e){return this.$store.getters.getShowImageLink(e)},getSeasonImageLink:function(e,t){return e.seasons[t].imgLink?e.seasons[t].imgLink:this.getShowImageLink(e)},createNewEntry:function(){this.editingShowId="",this.editingShowInfo={id:v.getGUID(),title:"",seasons:[]},this.openEditModal()},editShowEntry:function(e){this.editingShowInfo=v.deepClone(this.filteredCatalog[e]),this.editingShowId=this.editingShowInfo.id,this.openEditModal()},saveShowEntry:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.catalog.findIndex((function(t){return t.id===e.editingShowId})),-1===n?e.catalog.push(e.editingShowInfo):e.catalog[n]=e.editingShowInfo,e.catalog.sort((function(e,t){var n=e.title.toLowerCase().split(/^the /).reverse()[0],a=t.title.toLowerCase().split(/^the /).reverse()[0];return n.localeCompare(a)})),t.next=5,e.$store.dispatch("updateCatalog",e.catalog);case 5:case"end":return t.stop()}}),t)})))()},searchTMDB:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(""!==e){n.next=4;break}t.tmdbShowResults=[],n.next=7;break;case 4:return n.next=6,bt.searchTVShows(e);case 6:t.tmdbShowResults=n.sent;case 7:case"end":return n.stop()}}),n)})))()},openEditModal:function(){this.$bvModal.show("editModal")},closeEditModal:function(){this.$bvModal.hide("editModal")},onModalClose:function(){this.selectedItemId="",this.searchString="",this.$emit("hidden")}}}),yt=wt,xt=(n("2303"),Object(J["a"])(yt,Ke,Ze,!1,null,"515c93c2",null)),St=xt.exports,kt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-button",{style:e.paddingStyle,attrs:{id:"main-button",variant:e.variant?e.variant:"outline-secondary",pill:""},on:{click:function(t){return e.$emit("click")}}},[n("b-icon",{staticStyle:{cursor:"pointer","margin-bottom":"-2px"},attrs:{icon:e.icon,"font-scale":e.scale?e.scale:"1"}})],1)},Ct=[],_t=a["default"].extend({name:"IconButton",props:{icon:String,scale:String,variant:String},computed:{isMobile:function(){return window.innerWidth<992},paddingStyle:function(){return"padding: ".concat(this.isMobile?"10px 14px 14px":"12px 14px")}}}),It=_t,Tt=Object(J["a"])(It,kt,Ct,!1,null,null,null),Rt=Tt.exports,zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"full-item"}},[a("div",{attrs:{id:"item-details"}},[a("div",{attrs:{id:"info-section"}},[a("thumbnail-image",{staticStyle:{"margin-right":"5px"},attrs:{link:e.imageLink,height:100}}),a("div",[e.loadedShowInfo?a("div",{attrs:{id:"item-name"}},[a("span",[e._v(e._s(e.loadedShowInfo.title))]),"backlog"!==e.parentList?[e.loadedShowSeason.name?a("span",[e._v(" "+e._s(e.loadedShowSeason.name)+" ")]):a("span",[e._v(" Season "+e._s(e.loadedShowSeason.seasonNumber)+" ")])]:e._e()],2):e._e(),e.editedSeasonView?a("div",{attrs:{id:"viewed-dates"}},[e.editedSeasonView.beganDate?a("div",[e._v(" Started "+e._s(e._f("formatDate")(e.editedSeasonView.beganDate))+" ")]):e._e(),e.editedSeasonView.completedDate?a("div",[e._v(" Completed "+e._s(e._f("formatDate")(e.editedSeasonView.completedDate))+" ")]):e._e()]):e._e(),"upcoming"===e.parentList&&e.loadedShowSeason?a("div",{attrs:{id:"release-date"}},[e._v(" Airing "+e._s(e._f("formatDate")(e.loadedShowSeason.startDate))+" ")]):e._e()])],1),e.doProgressBar&&e.editedSeasonView&&!e.isReadOnly?a("div",{key:e.rerenderKey,style:e.getProgressBar(),attrs:{id:"progress-section"}},[e.editedSeasonView.beganDate?a("div",{staticClass:"counts"},[a("span",{on:{click:e.toggleEpisodeCountUnits}},[e._v(" Progress: ")]),e.doManualProgressEdit?a("span",{staticStyle:{display:"inline-block"}},[a("b-form-input",{staticStyle:{width:"75px","font-size":"0.8em"},attrs:{type:"number",max:e.maxValidProgress,min:e.minValidProgress,state:!!e.isEditedProgressValid&&null,size:"sm",inputmode:"numeric",pattern:"[0-9]*",autofocus:""},on:{blur:e.saveManualProgressEdit,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveManualProgressEdit.apply(null,arguments)}},model:{value:e.editedProgress,callback:function(t){e.editedProgress=e._n(t)},expression:"editedProgress"}})],1):a("span",{staticStyle:{cursor:"pointer"},on:{click:e.enableManualProgressEdit}},[e._v(" "+e._s(e.displayedEpisodeProgress?e.displayedEpisodeProgress:"-")+" ")]),a("span",[e._v(" / ")]),e.releaseSchedule&&0!==e.releaseSchedule.length?a("div",{staticClass:"live-episode-release-details"},[a("table",[a("tr",[a("td",[e._v(" "+e._s(e.displayedAvailableEpisodeCount?e.displayedAvailableEpisodeCount:"?")+" ")]),a("td",[e._v(" available ")])]),a("tr",[a("td",[e._v(" "+e._s(e.displayedTotalEpisodeCount?e.displayedTotalEpisodeCount:"?")+" ")]),a("td",[e._v(" total ")])])])]):a("span",[e._v(" "+e._s(e.displayedTotalEpisodeCount?e.displayedTotalEpisodeCount:"?")+" ")]),e.doEpisodeCountUnitsLabel?a("span",{key:e.doEpisodeCountOverall,staticClass:"episode-count-units"},[e._v(" ("+e._s(e.doEpisodeCountOverall?"Overall":"This season")+") ")]):e._e()]):e._e(),e.editedSeasonView.beganDate?e.isSeasonProgressComplete||e.isUpToDateWithLiveSeason?e._e():a("hover-icon",{attrs:{id:"increment-button",icon:"plus-circle",scale:"1.3",variant:"light"},on:{click:function(t){return e.incrementProgress()}}}):a("div",{staticStyle:{width:"100%","text-align":"center"}},[a("div",{attrs:{id:"begin-watching-button"},on:{click:e.beginSeason}},[e._v(" Begin watching ")])])],1):e._e(),!e.isReadOnly&&(e.itemMessages.length>0||e.itemButton)?a("div",{attrs:{id:"modify-item-container"}},[e._l(e.itemMessages,(function(t,n){return a("div",{key:n},[e._v(" "+e._s(t)+" ")])})),null!=e.itemButton?a("div",{attrs:{id:"modify-item-button"},on:{click:function(t){return e.itemButton.action.apply(e.itemButton,e.itemButton.args)}}},[e._v(" "+e._s(e.itemButton.label)+" ")]):e._e()],2):e._e()]),e.isReadOnly?e._e():a("div",{attrs:{id:"side-info"}},[a("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"text-decoration-none",variant:"transparent",size:"sm"},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("b-icon",{attrs:{icon:"three-dots-vertical"}})]},proxy:!0}],null,!1,374507881)},[e._t("dropdown-items",(function(){return[e.isPromotable?a("b-dropdown-item",{on:{click:function(t){return e.promoteItem()}}},[e._v(" Promote to "+e._s("queue"===e.parentList?"Main":"Queue")+" ")]):e._e(),"upcoming"===e.parentList?[a("b-dropdown-item",{on:{click:function(t){return e.promoteItem("live")}}},[e._v(" Promote to Live ")]),a("b-dropdown-item",{on:{click:function(t){return e.promoteItem("main")}}},[e._v(" Promote to Main ")])]:e._e(),"live"===e.parentList?a("b-dropdown-item",{on:{click:function(t){return e.promoteItem()}}},[e._v(" Move to Main ")]):e._e(),e.isDemotable?a("b-dropdown-item",{on:{click:e.demoteItem}},[e._v(" Demote to Queue ")]):e._e(),a("b-dropdown-item",{on:{click:e.removeItem}},[e._v(" "+e._s(e.seasonView?"Drop":"Remove")+" ")]),e.doReleaseSchedule?a("b-dropdown-item",{on:{click:e.openScheduleModal}},[e._v(" View Release Schedule ")]):e._e()]}))],2),a("div",{staticStyle:{"text-align":"center"}},[e.isReorderable?a("img",{staticClass:"drag-handle",attrs:{src:n("035d")}}):e._e()])],1),e.doReleaseSchedule&&e.loadedShowSeason?a("release-schedule-modal",{attrs:{"release-schedule":e.releaseSchedule,"show-season":e.loadedShowSeason,"available-episode-count":e.availableEpisodeCount,"parent-list":e.parentList},on:{"irregular-seasons-updated":function(t){return e.$emit("irregular-seasons-updated")}},scopedSlots:e._u([{key:"item-info",fn:function(){return[a("watchlist-item",{attrs:{"show-season":e.loadedShowSeason,"is-read-only":!0}})]},proxy:!0}],null,!1,3290024183)}):e._e()],1)},Dt=[],jt=n("1315"),Lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"release-schedule-modal-"+e.parentList+"-"+e.showSeason.id,title:"Projected Release Schedule",centered:"","ok-title":"Done","ok-variant":"outline-primary","ok-only":""}},[e._t("item-info"),n("div",{attrs:{id:"schedule-notes"}},[n("div",[e._v(" This is only a projection. Manually adjust the date of any episode to update the schedule. ")])]),n("table",{attrs:{id:"release-schedule-table"}},[n("thead",[n("tr",[n("th",{staticStyle:{width:"35%"}},[e._v(" Episode ")]),n("th",{staticStyle:{width:"65%"}},[e._v(" Date ")])])]),n("tbody",[e.isLoading?n("div",{staticClass:"loading-cover"},[n("b-spinner",{attrs:{variant:"light"}})],1):e._e(),e._l(e.releaseSchedule,(function(t){return n("tr",{key:t.episode,class:{"released-episode":t.episode<=e.availableEpisodeCount,"latest-episode":t.episode===e.availableEpisodeCount}},[n("td",[e._v(" "+e._s(t.episode)+" ")]),n("td",[t.episode===e.editingEpisode?n("div",{staticClass:"date-editor"},[e.conflictingIrregularEpisodes.length>0?n("div",{staticClass:"invalid-entry-message"},[e._v(" This conflicts with other episode dates. ")]):e._e(),n("b-form-datepicker",{staticStyle:{margin:"2px 0"},attrs:{min:e.showSeason.startDate,size:"sm",state:e.datePickerState,"label-help":""},model:{value:e.editingDate,callback:function(t){e.editingDate=t},expression:"editingDate"}}),n("div",[n("b-button",{attrs:{variant:"secondary",size:"sm",disabled:e.isLoading},on:{click:function(t){return e.closeDateEditor()}}},[e._v(" Cancel ")]),n("b-button",{attrs:{variant:"warning",size:"sm",disabled:!e.isEditingDateIrregular||e.isLoading},on:{click:function(t){return e.setIrregularDate(!0)}}},[e._v(" Reset ")]),n("b-button",{attrs:{variant:"primary",size:"sm",disabled:!e.isEditingDateChanged||e.isLoading||e.conflictingIrregularEpisodes.length>0},on:{click:function(t){return e.setIrregularDate()}}},[e._v(" Save ")])],1)],1):n("div",{class:["schedule-date",{"irregular-date":e.isIrregularlyScheduledEpisode(t.episode),"invalid-date":e.isConflictingIrregularDate(t.episode),clickable:!e.isLoading&&1!==t.episode}],on:{click:function(n){return e.editEpisodeDate(t)}}},[e._v(" "+e._s(e.formatReleaseDate(t.date))+" ")])])])})),void 0==e.showSeason.totalEpisodeCount?n("tr",{staticStyle:{"background-color":"#0001","font-size":"0.7em",color:"#0008"}},[n("td",{attrs:{colspan:"2"}},[n("div",{staticStyle:{padding:"2px"}},[n("span",{staticStyle:{"margin-right":"2px"}},[n("b-icon",{attrs:{icon:"exclamation-circle"}})],1),e._v(" The number of episodes shown may be inaccurate because the total episode count for this season is unset. ")])])]):e._e()],2)])],2)],1)},Et=[],Mt=a["default"].extend({name:"ReleaseScheduleModal",props:{releaseSchedule:{type:Array,required:!0},showSeason:{type:Object,required:!0},availableEpisodeCount:{type:Number,required:!0},parentList:{type:String,required:!0}},data:function(){return{editingEpisode:-1,editingDate:""}},computed:{datePickerState:function(){return!(this.conflictingIrregularEpisodes.length>0)&&(!!(this.editingEpisode>0&&this.isIrregularlyScheduledEpisode(this.editingEpisode))||null)},isEditingDateChanged:function(){return this.editingEpisode>0&&this.releaseSchedule[this.editingEpisode-1].date.toISODate()!==this.editingDate},isEditingDateIrregular:function(){return this.editingEpisode>0&&this.isIrregularlyScheduledEpisode(this.editingEpisode)},isLoading:function(){return this.$store.state.watchlist.isUpdatingSeason},conflictingIrregularEpisodes:function(){var e=this;return this.editingEpisode>0&&this.showSeason.irregularDates?this.showSeason.irregularDates.filter((function(t){return t.episode<e.editingEpisode&&t.date>e.editingDate||t.episode>e.editingEpisode&&t.date<e.editingDate})).map((function(e){return e.episode})):[]}},methods:{formatReleaseDate:function(e){return e.toFormat("EEEE, M/d/yyyy")},isIrregularlyScheduledEpisode:function(e){var t,n;return null!==(t=null===(n=this.showSeason.irregularDates)||void 0===n?void 0:n.some((function(t){return t.episode===e})))&&void 0!==t&&t},isConflictingIrregularDate:function(e){return this.conflictingIrregularEpisodes.includes(e)},editEpisodeDate:function(e){this.isLoading||1===e.episode||(this.editingEpisode=e.episode,this.editingDate=e.date.toISODate())},closeDateEditor:function(){this.editingEpisode=-1},setIrregularDate:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,s,r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]&&e[0],t.isLoading){n.next=12;break}return s=v.deepClone(t.showSeason),r=null!==(i=s.irregularDates)&&void 0!==i?i:[],o=r.findIndex((function(e){return e.episode===t.editingEpisode})),-1===o?r.push({episode:t.editingEpisode,date:t.editingDate}):a?r.splice(o,1):r[o].date=t.editingDate,r.sort((function(e,t){return e.episode-t.episode})),s.irregularDates=r,n.next=10,t.updateShowSeason(s);case 10:t.$emit("irregular-seasons-updated"),t.closeDateEditor();case 12:case"end":return n.stop()}}),n)})))()},updateShowSeason:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("updateCatalogShowSeason",e);case 2:case"end":return n.stop()}}),n)})))()}}}),Ot=Mt,At=(n("1f8f"),Object(J["a"])(Ot,Lt,Et,!1,null,"3d67a0ca",null)),Pt=At.exports,Vt=a["default"].extend({name:"WatchlistItem",components:{releaseScheduleModal:Pt,thumbnailImage:rt,hoverIcon:We},props:{parentList:{type:String,required:!1,default:"queue"},seasonView:{type:Object,required:!1},showSeason:{type:Object,required:!1},showInfo:{type:Object,required:!1},isReadOnly:{type:Boolean,required:!1,default:!1},isReorderable:{type:Boolean,required:!1,default:!1}},data:function(){return{editedSeasonView:null,doEpisodeCountOverall:!1,doEpisodeCountUnitsLabel:!1,doManualProgressEdit:!1,editedProgress:0,rerenderKey:""}},computed:{loadedShowInfo:function(){if(this.showInfo)return this.showInfo;var e=this.editedSeasonView?this.editedSeasonView.seasonInfo:this.showSeason;return e?this.$store.getters.getShowInfoById(e.showId):null},loadedShowSeason:function(){return this.showSeason?this.showSeason:this.editedSeasonView?this.editedSeasonView.seasonInfo:null},imageLink:function(){if(this.editedSeasonView||this.showSeason){var e=this.editedSeasonView?this.editedSeasonView.seasonInfo:this.showSeason;if(null!==e&&void 0!==e&&e.imgLink)return e.imgLink;if(void 0!=e)return this.$store.getters.getImageLink(e.showId,e.id)}else if(this.showInfo)return this.$store.getters.getShowImageLink(this.showInfo);return""},doProgressBar:function(){return"main"===this.parentList||"live"===this.parentList},previousSeasonsEpisodeCount:function(){if(this.loadedShowSeason&&this.loadedShowInfo){var e=this.loadedShowSeason.seasonNumber;return this.loadedShowInfo.seasons.reduce((function(t,n){return t+(e>n.seasonNumber&&n.totalEpisodeCount?n.totalEpisodeCount:0)}),0)}return 0},overallEpisodeProgress:function(){return this.editedSeasonView?this.editedSeasonView.watchedEpisodes+this.previousSeasonsEpisodeCount:0},overallTotalEpisodeCount:function(){return this.editedSeasonView&&this.loadedShowInfo?this.loadedShowInfo.seasons.reduce((function(e,t){return e+(t.totalEpisodeCount?t.totalEpisodeCount:0)}),0):0},displayedEpisodeProgress:function(){return this.doEpisodeCountOverall?this.overallEpisodeProgress:this.editedSeasonView?this.editedSeasonView.watchedEpisodes:0},displayedTotalEpisodeCount:function(){return this.doEpisodeCountOverall?this.overallTotalEpisodeCount:this.loadedShowSeason&&this.loadedShowSeason.totalEpisodeCount?this.loadedShowSeason.totalEpisodeCount:0},minValidProgress:function(){return this.doEpisodeCountOverall?this.previousSeasonsEpisodeCount:0},maxValidProgress:function(){var e,t=null===(e=this.loadedShowSeason)||void 0===e?void 0:e.totalEpisodeCount;return null==t?1/0:t+this.minValidProgress},isEditedProgressValid:function(){return this.editedProgress>=this.minValidProgress&&this.editedProgress<=this.maxValidProgress},isSeasonProgressComplete:function(){var e,t;return!(null===(e=this.loadedShowSeason)||void 0===e||!e.totalEpisodeCount)&&this.loadedShowSeason.totalEpisodeCount===(null===(t=this.editedSeasonView)||void 0===t?void 0:t.watchedEpisodes)},isPromotable:function(){return"queue"===this.parentList||"backlog"===this.parentList},isDemotable:function(){return"main"===this.parentList||"live"===this.parentList},hasBegunAiring:function(){if(this.loadedShowSeason&&this.loadedShowSeason.startDate){var e=v.getToday();return this.loadedShowSeason.startDate<=e}return!1},doReleaseSchedule:function(){return"live"===this.parentList||"upcoming"===this.parentList},releaseSchedule:function(){var e=this,t=[];if(this.doReleaseSchedule&&this.loadedShowSeason&&this.loadedShowSeason.startDate){var n=jt["DateTime"].fromISO(this.loadedShowSeason.startDate);if(n.isValid){var a;t=[{episode:1,date:n}];for(var i=null!==(a=this.loadedShowSeason.totalEpisodeCount)&&void 0!==a?a:30,s=n,r=function(n){var a,i=null===(a=e.loadedShowSeason.irregularDates)||void 0===a?void 0:a.find((function(e){return e.episode>=n+1})),r=void 0;if((null===i||void 0===i?void 0:i.episode)===n+1)r=jt["DateTime"].fromISO(i.date);else{var o=s.plus({days:7});r=i?jt["DateTime"].min(jt["DateTime"].fromISO(i.date),o):o}s=r,t.push({episode:n+1,date:r})},o=1;o<i;o++)r(o)}}return t},availableEpisodeCount:function(){var e=jt["DateTime"].now();return this.releaseSchedule.filter((function(t){return t.date<=e})).length},displayedAvailableEpisodeCount:function(){var e,t=null!==(e=this.loadedShowSeason)&&void 0!==e&&e.totalEpisodeCount?this.loadedShowSeason.totalEpisodeCount:0,n=Math.max(0,t-this.availableEpisodeCount);return this.doEpisodeCountOverall?this.overallTotalEpisodeCount-n:this.availableEpisodeCount},isSeasonFullyReleased:function(){var e,t;return this.availableEpisodeCount===(null!==(e=null===(t=this.loadedShowSeason)||void 0===t?void 0:t.totalEpisodeCount)&&void 0!==e?e:-1)},isUpToDateWithLiveSeason:function(){var e;return"live"===this.parentList&&(null===(e=this.editedSeasonView)||void 0===e?void 0:e.watchedEpisodes)===this.availableEpisodeCount},itemMessages:function(){var e=[];return"live"!==this.parentList||this.isSeasonFullyReleased?"upcoming"===this.parentList&&this.hasBegunAiring&&e.push("This item has begun airing!"):(this.isUpToDateWithLiveSeason&&e.push("Up to date!"),e.push("Next episode expected ".concat(this.formatReleaseDate(this.releaseSchedule[this.availableEpisodeCount].date)))),e},itemButton:function(){return this.isSeasonProgressComplete&&!this.isReadOnly?{label:"Mark season completed",action:this.markSeasonCompleted,args:[]}:"upcoming"===this.parentList&&this.hasBegunAiring?{label:"Move to Live",action:this.promoteItem,args:["live"]}:null}},created:function(){var e;this.seasonView&&(this.editedSeasonView=this.seasonView),this.doEpisodeCountOverall=(null===(e=this.loadedShowInfo)||void 0===e?void 0:e.doEpisodeCountOverall)||!1},watch:{seasonView:function(){var e;this.editedSeasonView=null!==(e=this.seasonView)&&void 0!==e?e:null}},methods:{formatReleaseDate:function(e){return e.toFormat("EEEE, M/d/yyyy")},getProgressBar:function(){var e,t="border-radius: 0 0 0 ".concat(this.itemMessages.length>0||this.itemButton?"0":"8px",";"),n=-1,a=-1;this.displayedTotalEpisodeCount?(n=100*this.displayedEpisodeProgress/this.displayedTotalEpisodeCount,this.displayedAvailableEpisodeCount&&"live"===this.parentList&&null!==(e=this.editedSeasonView)&&void 0!==e&&e.beganDate&&(a=100*this.displayedAvailableEpisodeCount/this.displayedTotalEpisodeCount),t+="background-image: linear-gradient(to right, "+"hsl(222, 71%, 60%) ".concat(n,"%, ")+(-1===a?"":"hsl(222, 60%, 67.5%) ".concat(n,"%, "))+(-1===a?"":"hsl(222, 60%, 67.5%) ".concat(a,"%, "))+"hsl(222, 71%, 75%) ".concat(Math.max(n,a),"%);")):t+="background-image: linear-gradient(to right, hsl(222, 71%, 60%) 25%, hsl(222, 71%, 75%) 75%);";return t},incrementProgress:function(){if(this.editedSeasonView){var e=this.editedSeasonView.seasonInfo.totalEpisodeCount;(null==e||this.editedSeasonView.watchedEpisodes<e)&&(this.editedSeasonView.watchedEpisodes++,this.saveChanges())}},toggleEpisodeCountUnits:function(){this.doEpisodeCountUnitsLabel=!0,this.doEpisodeCountOverall=!this.doEpisodeCountOverall},enableManualProgressEdit:function(){this.doManualProgressEdit=!0,this.editedProgress=this.displayedEpisodeProgress},saveManualProgressEdit:function(){if(this.editedSeasonView){if(this.isEditedProgressValid&&this.editedProgress!==this.displayedEpisodeProgress){var e=this.doEpisodeCountOverall?this.editedProgress-this.previousSeasonsEpisodeCount:this.editedProgress;this.editedSeasonView.watchedEpisodes=e,this.saveChanges()}this.doManualProgressEdit=!1}},beginSeason:function(){this.editedSeasonView&&!this.editedSeasonView.beganDate&&(this.editedSeasonView.beganDate=v.getTimestamp(),this.saveChanges()),this.rerenderKey=v.getTimestamp()},promoteItem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.$emit("promote-item",e)},demoteItem:function(){this.$emit("demote-item")},removeItem:function(){this.$emit("remove-item")},markSeasonCompleted:function(){this.$emit("mark-completed")},saveChanges:function(){this.editedSeasonView&&(V.SaveSeasonViewDebounced(this.editedSeasonView),this.$emit("season-view-updated",this.editedSeasonView))},openScheduleModal:function(){this.loadedShowSeason&&this.$bvModal.show("release-schedule-modal-".concat(this.parentList,"-").concat(this.loadedShowSeason.id))}}}),$t=Vt,Wt=(n("ebbe"),Object(J["a"])($t,zt,Dt,!1,null,"86b5fefc",null)),Nt=Wt.exports,Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"section"}},[n("div",{attrs:{id:"header"}},[n("div",{attrs:{id:"header-title"}},[n("div",[e._v(" "+e._s(e._f("toTitleCase")(e.listType))+" ")]),n("div",[e._v(" "+e._s(e.items.length+" item"+(1===e.items.length?"":"s"))+" ")])]),n("b-button",{attrs:{id:"add-button",variant:"outline-light",pill:""},on:{click:function(t){return e.addItem()}}},[n("b-icon",{attrs:{icon:"plus",variant:"secondary","font-scale":"1.5"}})],1)],1),n("div",{attrs:{id:"item-list"}},[n("draggable",e._b({attrs:{group:e.listType,handle:".drag-handle",disabled:!e.isReorderable},on:{change:e.onReorder},model:{value:e.items,callback:function(t){e.items=t},expression:"items"}},"draggable",e.dragOptions,!1),[n("transition-group",{attrs:{type:"transition"}},e._l(e.items,(function(t,a){return n("watchlist-item",{key:t.id,attrs:{"parent-list":e.listType,"season-view":e.isSeasonView?t:void 0,"show-season":e.isShowSeason?t:void 0,"show-info":e.isShowInfo?t:void 0,"is-reorderable":e.isReorderable},on:{"mark-completed":function(n){return e.$emit("mark-item-completed",t.id,e.listType)},"promote-item":function(n){return e.$emit("promote-item",t.id,e.listType,n)},"demote-item":function(n){return e.$emit("demote-item",t.id,e.listType)},"remove-item":function(n){return e.$emit("remove-item",t.id,e.listType)},"season-view-updated":function(t){return e.updateSeasonView(a,t)},"irregular-seasons-updated":function(t){return e.$emit("irregular-seasons-updated")}}})})),1)],1)],1)])},Ut=[],qt=n("b76a"),Ht=n.n(qt),Ft=a["default"].extend({name:"WatchlistSection",components:{watchlistItem:Nt,draggable:Ht.a},props:{listType:{type:String,required:!0},value:{type:Array,required:!0}},data:function(){return{items:[],dragOptions:{animation:200,ghostClass:"drag-ghost"}}},computed:{isSeasonView:function(){return"main"===this.listType||"live"===this.listType||"queue"===this.listType},isShowSeason:function(){return"upcoming"===this.listType},isShowInfo:function(){return"backlog"===this.listType},isReorderable:function(){return"queue"===this.listType||"backlog"===this.listType}},watch:{value:function(){this.loadValue()}},created:function(){this.loadValue()},methods:{loadValue:function(){this.items=v.deepClone(this.value)},syncModel:function(){this.$emit("input",this.items)},onReorder:function(){this.syncModel(),this.$emit("reorder")},addItem:function(){this.$emit("add-item")},updateSeasonView:function(e,t){this.isSeasonView&&(this.items[e]=t,this.syncModel())}}}),Gt=Ft,Qt=(n("5964"),Object(J["a"])(Gt,Bt,Ut,!1,null,"27ac129b",null)),Jt=Qt.exports,Yt=a["default"].extend({name:"Watchlist",components:{catalogModal:St,watchlistSection:Jt,watchlistItem:Nt,iconButton:Rt,scrollToRefresh:ye},data:function(){return{watchlist:null,isLoading:!1,targetListName:null,targetSeasonView:null,targetShowSeason:null,targetShowInfo:null,targetNextQueueItem:null,doNextSeasonToQueue:!0,doPopQueueToMain:!0}},computed:{isReady:function(){return this.$store.getters.db_isReady}},watch:{isReady:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=3;break}return n.next=3,t.loadData();case 3:case"end":return n.stop()}}),n)})))()}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isReady){t.next=3;break}return t.next=3,e.loadData();case 3:case"end":return t.stop()}}),t)})))()},methods:{resetTargets:function(){this.targetListName=null,this.targetSeasonView=null,this.targetShowSeason=null,this.targetShowInfo=null,this.targetNextQueueItem=null},loadWatchlist:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]&&e[0],n.next=3,V.GetWatchlistData(a);case 3:t.watchlist=n.sent;case 4:case"end":return n.stop()}}),n)})))()},saveWatchlist:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.watchlist){t.next=3;break}return t.next=3,V.SaveWatchlistData(e.watchlist);case 3:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]&&e[0],t.isLoading=!0,n.next=4,t.$store.dispatch("loadCatalogFromDropbox");case 4:return n.next=6,t.loadWatchlist(a);case 6:t.isLoading=!1;case 7:case"end":return n.stop()}}),n)})))()},handleRefresh:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,V.ForceSaveSeasonViews();case 3:return t.next=5,e.loadData(!0);case 5:e.isLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},selectCatalogEntry:function(e){this.targetListName=e,this.openCatalog()},addCatalogItemToList:function(e,t){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.watchlist&&("main"===t||"live"===t||"queue"===t?(i={id:v.getGUID(),seasonInfo:e,watchedEpisodes:0},n.watchlist[t].push(i)):"upcoming"===t?(n.watchlist.upcoming.push(e),n.watchlist.upcoming.sort((function(e,t){var n,a;return(null!==(n=e.startDate)&&void 0!==n?n:"z").localeCompare(null!==(a=t.startDate)&&void 0!==a?a:"z")}))):"backlog"===t&&n.watchlist.backlog.push(e)),n.closeCatalog(),a.next=4,n.saveWatchlist();case 4:case"end":return a.stop()}}),a)})))()},showMarkCompletedOptions:function(e,t){if(this.targetListName=t,this.watchlist)if("main"===t){var n=this.watchlist.main.findIndex((function(t){return t.id===e}));if(-1!==n){this.doNextSeasonToQueue=!1,this.doPopQueueToMain=!1,this.targetSeasonView=this.watchlist.main[n],this.targetShowSeason=null;var a=this.targetSeasonView.seasonInfo,i=this.$store.getters.getShowInfoById(a.showId),s=i.seasons.findIndex((function(e){return e.id===a.id}));s<i.seasons.length-1&&(this.targetShowSeason=i.seasons[s+1],this.doNextSeasonToQueue=!0),this.targetNextQueueItem=null,this.watchlist.queue.length>0&&(this.targetNextQueueItem=this.watchlist.queue[0],this.doPopQueueToMain=!0),this.$bvModal.show("markCompletedModal")}}else if("live"===t){var r=this.watchlist.live.findIndex((function(t){return t.id===e}));-1!==r&&(this.doNextSeasonToQueue=!1,this.doPopQueueToMain=!1,this.targetShowSeason=null,this.targetNextQueueItem=null,this.targetSeasonView=this.watchlist.live[r],this.$bvModal.show("markCompletedModal"))}},markSeasonCompleted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.watchlist||!e.targetSeasonView){t.next=9;break}return e.targetSeasonView.completedDate=v.getTimestamp(),t.next=4,V.SaveSeasonViews([e.targetSeasonView]);case 4:return"main"!==e.targetListName&&"live"!==e.targetListName||(n=e.targetSeasonView.id,a=e.watchlist[e.targetListName].findIndex((function(e){return e.id===n})),-1!==a&&e.watchlist[e.targetListName].splice(a,1)),e.doNextSeasonToQueue&&e.targetShowSeason&&(i={id:v.getGUID(),seasonInfo:e.targetShowSeason,watchedEpisodes:0},e.watchlist.queue.push(i)),e.doPopQueueToMain&&e.targetNextQueueItem&&(e.watchlist.main.push(e.targetNextQueueItem),e.watchlist.queue.splice(0,1)),t.next=9,e.saveWatchlist();case 9:e.resetTargets();case 10:case"end":return t.stop()}}),t)})))()},promptConfirmRemoveItem:function(e,t){if(this.targetListName=t,this.watchlist){if("main"===t||"live"===t||"queue"===t){var n=this.watchlist[t].findIndex((function(t){return t.id===e}));this.targetSeasonView=this.watchlist[t][n]}else if("upcoming"===t){var a=this.watchlist.upcoming.findIndex((function(t){return t.id===e}));this.targetShowSeason=this.watchlist.upcoming[a]}else if("backlog"===t){var i=this.watchlist.backlog.findIndex((function(t){return t.id===e}));this.targetShowInfo=this.watchlist.backlog[i]}this.$bvModal.show("confirmRemoveModal")}},promoteItem:function(e,t){var n=arguments,a=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var s,r,o,c,l,u,d,h,m,p;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(s=n.length>2&&void 0!==n[2]?n[2]:void 0,!a.watchlist){i.next=5;break}return"live"===t||"queue"===t?(r=a.watchlist[t].findIndex((function(t){return t.id===e})),-1!==r&&(o=a.watchlist[t][r],a.watchlist.main.push(o),a.watchlist[t].splice(r,1))):"upcoming"===t?(c=a.watchlist.upcoming.findIndex((function(t){return t.id===e})),-1!==c&&(l=a.watchlist.upcoming[c],u={id:v.getGUID(),seasonInfo:l,watchedEpisodes:0},s&&"live"!==s?"main"===s&&a.watchlist.main.push(u):a.watchlist.live.push(u),a.watchlist.upcoming.splice(c,1))):"backlog"===t&&(d=a.watchlist.backlog.findIndex((function(t){return t.id===e})),-1!==d&&(h=a.watchlist.backlog[d],h.seasons.length>0&&(m=h.seasons[0],p={id:v.getGUID(),seasonInfo:m,watchedEpisodes:0},a.watchlist.queue.push(p)),a.watchlist.backlog.splice(d,1))),i.next=5,a.saveWatchlist();case 5:case"end":return i.stop()}}),i)})))()},demoteItem:function(e,t){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!n.watchlist){a.next=4;break}return"main"!==t&&"live"!==t||(i=n.watchlist[t].findIndex((function(t){return t.id===e})),-1!==i&&(s=n.watchlist[t][i],n.watchlist.queue.splice(0,0,s),n.watchlist[t].splice(i,1))),a.next=4,n.saveWatchlist();case 4:case"end":return a.stop()}}),a)})))()},removeItem:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,s,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.watchlist){t.next=13;break}if("main"!==e.targetListName&&"live"!==e.targetListName&&"queue"!==e.targetListName||!e.targetSeasonView){t.next=10;break}return e.targetSeasonView.droppedDate=v.getTimestamp(),t.next=5,V.SaveSeasonViews([e.targetSeasonView]);case 5:n=e.targetSeasonView.id,a=e.watchlist[e.targetListName].findIndex((function(e){return e.id===n})),-1!==a&&e.watchlist[e.targetListName].splice(a,1),t.next=11;break;case 10:"upcoming"===e.targetListName&&e.targetShowSeason?(i=e.targetShowSeason.id,s=e.watchlist.upcoming.findIndex((function(e){return e.id===i})),-1!==s&&e.watchlist.upcoming.splice(s,1)):"backlog"===e.targetListName&&e.targetShowInfo&&(r=e.targetShowInfo.id,o=e.watchlist.backlog.findIndex((function(e){return e.id===r})),-1!==o&&e.watchlist.backlog.splice(o,1));case 11:return t.next=13,e.saveWatchlist();case 13:e.resetTargets();case 14:case"end":return t.stop()}}),t)})))()},onReorderList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.saveWatchlist();case 2:case"end":return t.stop()}}),t)})))()},openCatalog:function(){this.$bvModal.show("catalogModal")},closeCatalog:function(){this.$bvModal.hide("catalogModal")},onModalHide:function(e){"ok"!==e.trigger&&this.resetTargets()}}}),Kt=Yt,Zt=(n("8940"),Object(J["a"])(Kt,Je,Ye,!1,null,"5c8b316c",null)),Xt=Zt.exports,en=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p-3"},[n("b-card",{attrs:{"no-body":""}},[n("b-tabs",{attrs:{pills:"",lazy:"",card:""}},[n("b-tab",{attrs:{title:"Image Analyzer",active:""}},[n("image-analyzer")],1),n("b-tab",{attrs:{title:"Ray Tracer"}},[n("canvas-test")],1),n("b-tab",{attrs:{title:"Sandbox"}},[n("sandbox-game")],1),n("b-tab",{attrs:{title:"Droplet Ring"}},[n("b-form-spinbutton",{staticStyle:{margin:"10px"},attrs:{min:"2",max:"10",wrap:"",inline:""},model:{value:e.dropletCount,callback:function(t){e.dropletCount=t},expression:"dropletCount"}}),n("droplet-ring",{staticStyle:{"max-width":"500px"},attrs:{n:e.dropletCount}})],1)],1)],1)],1)},tn=[],nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-input-group",{scopedSlots:e._u([{key:"append",fn:function(){return[n("b-button",{on:{click:e.initImage}},[e._v("Analyze Image")])]},proxy:!0}])},[n("b-form-input",{attrs:{placeholder:"URL",debounce:"500"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1),n("img",{staticStyle:{"max-width":"250px","max-height":"250px","margin-top":"20px"},attrs:{src:e.url}}),n("div",{style:e.selectedColorsStyle},[e._v(" ")]),n("div",[n("div",[e.allColors.length>0?n("color-histogram",{staticStyle:{width:"100%",margin:"20px 0"},attrs:{"all-colors":e.allColors}}):e._e()],1),n("div",{attrs:{id:"color-samples"}},e._l(e.allColors,(function(t,a){return n("div",{key:a,style:e.getColorSampleStyle(t)},[e._v(" RGB: "+e._s(e.getColorString(t.colorRGB))),n("br"),e._v(" HSL: "+e._s(e.getColorString(t.colorHSL))),n("br"),e._v(" Count: "+e._s(t.count)+" ")])})),0)])],1)},an=[],sn=n("53ca"),rn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"svg-container"}},[n("svg",{attrs:{viewBox:"0 0 360 110"}},[n("defs",[n("linearGradient",{attrs:{id:"x-axis-gradient"}},e._l(e.xAxisColors,(function(e,t){return n("stop",{key:t,attrs:{offset:e.offset,"stop-color":e.color}})})),1)],1),n("rect",{attrs:{x:"0",y:"0",width:"100%",height:"100%",fill:"#def6"}}),n("g",{attrs:{id:"background-lines"}}),n("g",{attrs:{id:"values"}},e._l(e.colorBuckets,(function(t,a){return n("line",{key:a,attrs:{x1:t.hueAvg,x2:t.hueAvg,y1:"100",y2:100-100*t.count/e.allColors.length,"stroke-width":e.bucketWidth/2,stroke:"hsl("+t.hueAvg+", 80%, 50%)"}})})),0),n("g",{attrs:{id:"axes"}},[n("rect",{attrs:{x:"0",y:"100",width:"100%",height:1e3/110+"%",fill:"url(#x-axis-gradient)"}})])])])},on=[],cn=a["default"].extend({name:"ColorHistogram",props:{allColors:{type:Array,required:!0}},data:function(){return{xAxisDivisions:32}},computed:{bucketWidth:function(){return 360/this.xAxisDivisions},colorBuckets:function(){var e=this,t=Array.from(new Array(this.xAxisDivisions).keys()).map((function(t){return{hueMin:t*e.bucketWidth,hueMax:t*e.bucketWidth+e.bucketWidth,hueAvg:t*e.bucketWidth+e.bucketWidth/2,count:0}}));return this.allColors.forEach((function(n){var a=Math.floor(n.colorHSL[0]/e.bucketWidth);t[a].count++})),t},xAxisColors:function(){for(var e=[{offset:"0%",color:"hsl(0, 80%, 50%)"}],t=0;t<this.xAxisDivisions;t++)e.push({offset:100*(t+1)/this.xAxisDivisions+"%",color:"hsl(".concat(360*(t+1)/this.xAxisDivisions,", 80%, 50%)")});return e}},methods:{}}),ln=cn,un=(n("bb5b"),Object(J["a"])(ln,rn,on,!1,null,"4ed23202",null)),dn=un.exports;function hn(e){var t=e[0]/255,n=e[1]/255,a=e[2]/255,i=e.length<4?1:e[3]/255,s=Math.min(t,n,a),r=Math.max(t,n,a),o=r-s,c=0,l=0,u=0;return c=0===o?0:r===t?(n-a)/o%6:r===n?(a-t)/o+2:(t-n)/o+4,c=Math.round(60*c),c<0&&(c+=360),u=(r+s)/2,l=0==o?0:o/(1-Math.abs(2*u-1)),l=Math.round(100*l),u=Math.round(100*u),[c,l,u,i]}var mn=function(e){return e.colorHSL[1]>20&&e.colorHSL[2]>20&&e.colorHSL[2]<=80},pn=function(e){var t=e.colorHSL[2]>50?100-e.colorHSL[2]:e.colorHSL[2],n=e.colorHSL[1];return 2*t+n};function fn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],i=document.createElement("canvas");if(i){i.height=e.naturalHeight,i.width=e.naturalWidth;var s=i.getContext("2d",{willReadFrequently:!0});if(s){s.drawImage(e,0,0);for(var r=s.getImageData(0,0,e.naturalWidth,e.naturalHeight),o=r.data,c={},l=0;l<o.length;l+=4){var u=o[l],d=o[l+1],h=o[l+2],m=o[l+3],p="".concat(u,"-").concat(d,"-").concat(h,"-").concat(t?m:"");if(void 0===c[p]){var f=[u,d,h,m];c[p]={colorRGB:f,colorHSL:hn(f),count:1}}else c[p].count+=1}a=Object.values(c),n&&(a=a.filter(mn)),a.sort((function(e,t){return pn(t)-pn(e)}))}}return i.remove(),a}var vn={GetFormattedColor:function(e){return"hsl(".concat(e.colorHSL[0],", ").concat(e.colorHSL[1],"%, ").concat(e.colorHSL[2],"%)")},GetImageColorData:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new Image,n.crossOrigin="anonymous",n.src=e,t.prev=3,t.next=6,n.decode();case 6:return t.abrupt("return",fn(n));case 9:return t.prev=9,t.t0=t["catch"](3),console.log("---- Issue loading image:"),console.log(t.t0),console.log("--------"),t.abrupt("return",[]);case 15:case"end":return t.stop()}}),t,null,[[3,9]])})))()}},gn=a["default"].extend({name:"ImageAnalyzer",components:{colorHistogram:dn},data:function(){return{url:"https://picsum.photos/600/300/?image=400",allColors:[]}},computed:{selectedColorsStyle:function(){var e=this;if(0===this.allColors.length)return"display: none";var t=function(){for(var t=3,n=10,a=[],i=[],s=function(s){var r=e.allColors[s].colorHSL[0];if(!a.some((function(e){return e+n>r&&e-n<r}))&&(i.push(vn.GetFormattedColor(e.allColors[s])),a.push(r),i.length>=t))return"break"},r=0;r<e.allColors.length;r++){var o=s(r);if("break"===o)break}var c="background-image: linear-gradient(to right, ";return i.forEach((function(e,t){var n=100*t/i.length,a=100*(t+1)/i.length;c+="".concat(e," ").concat(n,"%, ").concat(e," ").concat(a,"%")+(t===i.length-1?"":", ")})),c+="); height: 20px; width: 100%; margin-top: 5px;",{v:c}}();return"object"===Object(sn["a"])(t)?t.v:void 0}},methods:{getColorString:function(e){return"(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(Math.round(1e3*e[3])/1e3,")")},getColorSampleStyle:function(e){var t="background-color: hsla(".concat(e.colorHSL[0],", ").concat(e.colorHSL[1],"%, ").concat(e.colorHSL[2],"%, ").concat(e.colorHSL[3],");");return t+="color: ".concat(e.colorHSL[2]>50||e.colorHSL[3]<.5?"#000":"#fff",";"),t},initImage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,vn.GetImageColorData(e.url);case 2:e.allColors=t.sent;case 3:case"end":return t.stop()}}),t)})))()}}}),bn=gn,wn=(n("3da0"),Object(J["a"])(bn,nn,an,!1,null,"04736a9a",null)),yn=wn.exports,xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("b",{staticStyle:{"margin-right":"10px"}},[e._v("Scene:")]),n("b-form-spinbutton",{staticStyle:{margin:"10px auto",width:"200px"},attrs:{min:"0",max:"4",wrap:"",inline:""},on:{change:function(t){return e.generateCanvasImage()}},model:{value:e.mainSceneIdx,callback:function(t){e.mainSceneIdx=t},expression:"mainSceneIdx"}})],1),n("div",[n("b",{staticStyle:{"margin-right":"10px"}},[e._v("Size:")]),n("b-form-radio-group",{staticStyle:{margin:"10px auto",width:"200px"},attrs:{options:[{text:"Small",value:1},{text:"Large",value:2}],buttons:""},on:{change:function(t){return e.generateCanvasImage()}},model:{value:e.canvasSettingsControl.size,callback:function(t){e.$set(e.canvasSettingsControl,"size",t)},expression:"canvasSettingsControl.size"}})],1),n("canvas",{style:e.getWidthInfo+"border:1px solid #000000",attrs:{id:"c",width:e.canvasWidth,height:e.canvasHeight},on:{click:function(t){return e.look(t)}}}),e.loading?n("div",[n("b-spinner",{attrs:{variant:"secondary"}})],1):n("div",[n("div",[e._v(" "+e._s(e.allScenes[e.mainSceneIdx].items.length)+" items ")]),null!=e.subSceneCount?n("div",[e._v(" "+e._s(e.subSceneCount)+" sub scenes ")]):e._e()]),n("br"),e.startTime?n("div",[e._v(" Start: "+e._s(e.startTime.format("h:mm:ss"))+" ")]):e._e(),e.endTime?n("div",[e._v(" End: "+e._s(e.endTime.format("h:mm:ss"))+" ")]):e._e(),e.totalRuntime?n("div",[e._v(" "+e._s(e.totalRuntime)+" seconds total ")]):e._e(),e._l(e.captureTimes,(function(t,a){return n("div",{key:a,staticStyle:{"margin-left":"10px"}},[e._v(" Scene "+e._s(t.sceneIdx)+": ("+e._s(t.sceneSettings.pxRows)+"x"+e._s(t.sceneSettings.pxCols)+", "+e._s(t.sceneSettings.reflectLimit)+" ref, "+e._s(t.sceneSettings.superSampleLvl)+"xSS): "),n("b",[e._v(e._s(e.getRuntime(t.start,t.end))+" s")])])}))],2)},Sn=[],kn=(n("cb29"),n("b680"),n("c1df")),Cn=n.n(kn),_n=a["default"].extend({name:"CanvasTest",data:function(){return{vueCanvas:{},canvasSettingsControl:{size:1,reflectLimit:3,superSampleLvl:1},cMat:[],doOut:!1,startTime:null,endTime:null,captureTimes:[],subSceneCount:null,allScenes:[],mainSceneIdx:0,doGlobalCameraSettings:!0}},created:function(){var e=this;this.createKeydownListener();var t=[[{x:.75,y:0,z:0},{x:0,y:.75,z:0},{x:0,y:.5,z:0}],[{x:0,y:0,z:.75},{x:.75,y:0,z:.75},{x:.5,y:0,z:.75}],[{x:0,y:.75,z:.75},{x:.75,y:.75,z:0},{x:.75,y:.5,z:0}]],n=[],a={x:.4,y:.3,z:0},i={x:.8,y:.8,z:.7};n.push(new Array(8).fill({}).map((function(t,n){return n%2===1?e.vSubtract(i,a):e.vScale(a,0)})));for(var s=0;s<7;s++){for(var r=[],o=0;o<8;o++)r.push(s%2===o%2?i:a);n.push(r)}var c={color:{x:.6,y:.8,z:1}},l={color:{x:.6,y:1,z:.8}},u={color:{x:.8,y:1,z:.6}},d={color:{x:.9,y:.9,z:1},n:5,reflectivity:0},h={color:{x:.6,y:.5,z:.8},n:5,reflectivity:0,image:t},m={color:{x:.3,y:.3,z:.6},n:5,reflectivity:0},p={color:{x:.8,y:.3,z:.35},n:5,reflectivity:0},f={color:{x:.5,y:.8,z:.8},reflectivity:.5},v={color:{x:1,y:1,z:1},ka:.25,kd:.05,n:300,reflectivity:.8},g={color:{x:1,y:1,z:1},ka:.25,kd:.05,n:300,reflectivity:.8},b={color:{x:1,y:0,z:1},ka:.65,imgSrcSceneIdx:0},w={color:{x:1,y:0,z:1},ka:.75,imgSrcSceneIdx:3},y=2,x={x:-.75,y:1,z:-1},S={x:2,y:1,z:0};S=this.vScale(this.norm(S),2*y);var k={x:-.5,y:1,z:3.5};k=this.vScale(this.norm(k),1*y);var C={x:3.5,y:2.5,z:-1},_={x:2,y:-.5,z:0};_=this.vScale(this.norm(_),2*y);var I={x:.5,y:.5,z:3};I=this.vScale(this.norm(I),1*y);var T={pxCols:30,pxRows:15,reflectLimit:2,superSampleLvl:1};this.allScenes=[{camera:{pos:{x:2,y:-.5,z:0},dir:{x:0,y:1,z:0},up:{x:0,y:0,z:1},fov:[Math.PI/3.4,Math.PI/6],settings:T},A:.5,items:[{type:"sphere",c:{x:2,y:3.5,z:.5},r:.5,material:{color:{x:0,y:0,z:1}}},{type:"sphere",c:{x:3,y:2,z:0},r:1,material:{color:{x:0,y:.8,z:1},kd:.2}},{type:"sphere",c:{x:1,y:3,z:-1},r:.75,material:{color:{x:0,y:.4,z:.1}}},{type:"sphere",c:{x:0,y:3,z:1},r:.4,material:{color:{x:1,y:.4,z:.1}}},{type:"plane",p:{x:0,y:0,z:-1},n:{x:0,y:0,z:1},material:{color:{x:1,y:1,z:1},kd:.1,reflectivity:.5}},{type:"plane",p:{x:4,y:0,z:0},n:{x:-1,y:0,z:0},material:{color:{x:0,y:1,z:0},reflectivity:0}},{type:"plane",p:{x:-4,y:0,z:0},n:this.norm({x:1,y:0,z:1}),material:{color:{x:0,y:1,z:.6},reflectivity:0}},{type:"plane",p:{x:0,y:10,z:0},n:{x:0,y:-1,z:0},material:{color:{x:.5,y:.7,z:.8},reflectivity:0}},{type:"triangle",material:{color:{x:1,y:0,z:0}},v0:{x:1,y:2,z:-1},v1:{x:0,y:2,z:-.5},v2:{x:1,y:1.5,z:-1}},{type:"triangle",material:{color:{x:1,y:0,z:0}},v0:{x:1,y:1.5,z:-1},v1:{x:0,y:2,z:-.5},v2:{x:0,y:1.5,z:-.5}},{type:"triangle",material:{color:{x:1,y:0,z:0}},v0:{x:1,y:1.5,z:-1},v1:{x:0,y:1.5,z:-.5},v2:{x:0,y:1.5,z:-1}},{type:"triangle",material:{color:{x:1,y:0,z:0}},v0:{x:1,y:2,z:-1},v1:{x:0,y:2,z:-.5},v2:{x:0,y:2,z:-1}},{type:"tube",material:{color:{x:1,y:1,z:0}},p:{x:-1.5,y:3,z:-1},d:this.norm({x:2,y:1.5,z:2}),r:.4},{type:"cylinder",material:{color:{x:.4,y:.8,z:.6}},p0:{x:1.85,y:1.6,z:-.53},p1:{x:1.75,y:1.5,z:-.48},r:.5}],compoundItems:[],lights:[{p:{x:1.5,y:1,z:2.5},C:30},{p:{x:3,y:.5,z:-.9},C:.75}]},{camera:{pos:{x:.25,y:-1,z:0},dir:this.norm({x:2,y:5,z:-.5}),up:{x:0,y:0,z:1},fov:[Math.PI/3.4,Math.PI/6],settings:T},A:.5,items:[{type:"sphere",c:{x:3,y:2.5,z:-.2},r:.6,material:v},{type:"plane",p:{x:0,y:0,z:-1},n:{x:0,y:0,z:1},material:f},{type:"plane",p:{x:0,y:8,z:0},n:{x:0,y:-1,z:0},material:d},{type:"plane",p:{x:9,y:0,z:0},n:{x:-1,y:0,z:0},material:h}],compoundItems:[{type:"smoothPolygon",material:l,vertices:[{x:.2,y:4.8,z:-1},{x:1.8,y:4.8,z:-1},{x:1.8,y:2.2,z:-1},{x:.2,y:2.2,z:-1}],r:.2},{type:"smoothPolygon",material:c,vertices:[{x:2.2,y:4.8,z:-1},{x:4.8,y:4.8,z:-1},{x:4.8,y:2.2,z:-1},{x:2.2,y:2.2,z:-1}],r:.2},{type:"smoothPolygon",material:u,vertices:[{x:.2,y:1.8,z:-1},{x:4.8,y:1.8,z:-1},{x:4.8,y:1.2,z:-1},{x:.2,y:1.2,z:-1}],r:.2}],lights:[{p:{x:0,y:0,z:5},C:100}]},{camera:{pos:{x:2.5,y:-2.5,z:.5},dir:this.norm({x:0,y:1,z:0}),up:{x:0,y:0,z:1},fov:[Math.PI/3.4,Math.PI/6],settings:this.canvasSettings},A:.5,items:[{type:"parallelogram",material:b,p:x,u:S,v:k},{type:"parallelogram",material:w,p:C,u:_,v:I},{type:"plane",p:{x:0,y:0,z:-1},n:{x:0,y:0,z:1},material:f},{type:"plane",p:{x:0,y:8,z:0},n:{x:0,y:-1,z:0},material:d},{type:"plane",p:{x:9,y:0,z:0},n:{x:-1,y:0,z:0},material:h}],compoundItems:[],lights:[{p:{x:0,y:0,z:5},C:100},{p:{x:5,y:0,z:3},C:30}]},{camera:{pos:{x:2,y:.45,z:1},dir:this.norm({x:0,y:1,z:-.25}),up:{x:0,y:0,z:1},fov:[Math.PI/3.4,Math.PI/6],settings:this.canvasSettings},A:.5,voidColor:{x:.7,y:.8,z:1},items:[{type:"parallelogram",material:{color:{x:1,y:0,z:1},reflectivity:.1,image:n},p:{x:0,y:2,z:0},u:{x:4,y:0,z:0},v:{x:0,y:4,z:0}},{type:"parallelogram",material:{color:{x:.4,y:.3,z:0},kd:.4,reflectivity:.1},p:{x:0,y:2,z:-1},u:{x:4,y:0,z:0},v:{x:0,y:0,z:1}},{type:"sphere",material:g,c:{x:1.25,y:2.75,z:.4},r:.4},{type:"cylinder",material:m,p0:{x:3.25,y:2.25,z:.6},p1:{x:3.25,y:2.25,z:0},r:.15}],compoundItems:[],lights:[{p:{x:-.5,y:.5,z:8},C:300}]},{camera:{pos:{x:3,y:-.75,z:1.75},dir:this.norm({x:-.75,y:1.5,z:-1.5}),up:{x:0,y:0,z:1},fov:[Math.PI/3.4,Math.PI/6],settings:this.canvasSettings},A:.5,voidColor:{x:.7,y:.8,z:1},items:[{type:"parallelogram",material:{color:{x:1,y:0,z:1},reflectivity:.1,image:n},p:{x:0,y:0,z:0},u:{x:4,y:0,z:0},v:{x:0,y:4,z:0}},{type:"parallelogram",material:{color:{x:.4,y:.3,z:0},kd:.4,reflectivity:.1},p:{x:0,y:0,z:-3},u:{x:4,y:0,z:0},v:{x:0,y:0,z:3}},{type:"cylinder",material:l,p0:{x:2,y:.75,z:0},p1:{x:2,y:.75,z:1},r:.6,nullVolumes:[{type:"sphere",material:p,c:{x:2,y:.75,z:1},r:.4},{type:"tube",material:p,p:{x:2,y:.75,z:.5},d:{x:0,y:1,z:0},r:.3}]}],compoundItems:[],lights:[{p:{x:.5,y:-1,z:8},C:300}]}],this.allScenes.forEach((function(t,n){return t.compoundItems.forEach((function(t){return e.unpackCompound(t,n)}))})),this.allScenes.forEach((function(t){(e.doGlobalCameraSettings||void 0===t.camera.settings.pxRows)&&(t.camera.settings.pxRows=e.canvasSettings.pxRows),(e.doGlobalCameraSettings||void 0===t.camera.settings.pxCols)&&(t.camera.settings.pxCols=e.canvasSettings.pxCols),(e.doGlobalCameraSettings||void 0===t.camera.settings.reflectLimit)&&(t.camera.settings.reflectLimit=e.canvasSettings.reflectLimit),(e.doGlobalCameraSettings||void 0===t.camera.settings.refractLimit)&&(t.camera.settings.refractLimit=e.canvasSettings.refractLimit),(e.doGlobalCameraSettings||void 0===t.camera.settings.superSampleLvl)&&(t.camera.settings.superSampleLvl=e.canvasSettings.superSampleLvl),t.camera.image=[[{x:1,y:1,z:0}]],t.items.forEach((function(e){void 0===e.material.ka&&(e.material.ka=.5),void 0===e.material.kd&&(e.material.kd=.2),void 0===e.material.ks&&(e.material.ks=.1),void 0===e.material.n&&(e.material.n=50),void 0===e.material.reflectivity&&(e.material.reflectivity=.1)}))})),this.$nextTick((function(){var t=document.getElementById("c"),n=t.getContext("2d");null!==n&&(e.vueCanvas=n,e.generateCanvasImage())}))},computed:{totalRuntime:function(){return this.getRuntime(this.startTime,this.endTime)},getWidthInfo:function(){return window.innerWidth<this.canvasWidth?"max-width:"+this.canvasWidth+"px;":""},canvasWidth:function(){return 300*this.canvasSettingsControl.size},canvasHeight:function(){return 150*this.canvasSettingsControl.size},canvasSettings:function(){return{pxRows:this.canvasHeight,pxCols:this.canvasWidth,reflectLimit:3,superSampleLvl:1}},loading:function(){if(0===this.captureTimes.length)return!0;var e=this.captureTimes[this.captureTimes.length-1];return this.mainSceneIdx!==e.sceneIdx}},methods:{getRuntime:function(e,t){return e&&t?t.diff(e,"seconds",!0).toFixed(1):null},keyboardResponder:function(e){if("W"===e.key)this.move("up");else if("S"===e.key)this.move("down");else if("w"===e.key)this.move("forward");else if("s"===e.key)this.move("back");else if("a"===e.key)this.move("left");else if("d"===e.key)this.move("right");else if("l"===e.key){var t=this.allScenes[this.mainSceneIdx];console.log("Camera pos: "+this.vec3ToStr(t.camera.pos)),console.log("Camera dir: "+this.vec3ToStr(t.camera.dir))}},createKeydownListener:function(){window.removeEventListener("keydown",this.keyboardResponder),window.addEventListener("keydown",this.keyboardResponder)},move:function(e){console.log("Moving "+e);var t=this.allScenes[this.mainSceneIdx];"forward"===e?this.allScenes[this.mainSceneIdx].camera.pos=this.vAdd(t.camera.pos,t.camera.dir):"back"===e?this.allScenes[this.mainSceneIdx].camera.pos=this.vSubtract(t.camera.pos,t.camera.dir):"left"===e?this.allScenes[this.mainSceneIdx].camera.pos=this.vAdd(t.camera.pos,this.vCross(t.camera.up,t.camera.dir)):"right"===e?this.allScenes[this.mainSceneIdx].camera.pos=this.vSubtract(t.camera.pos,this.vCross(t.camera.up,t.camera.dir)):"up"===e?this.allScenes[this.mainSceneIdx].camera.pos=this.vAdd(t.camera.pos,t.camera.up):"down"===e&&(this.allScenes[this.mainSceneIdx].camera.pos=this.vSubtract(t.camera.pos,t.camera.up)),this.generateCanvasImage()},look:function(e){var t=document.getElementById("c");if(t){var n=t.getBoundingClientRect(),a=e.clientX-n.left-1,i=e.clientY-n.top-1;if(a>=0&&a<this.canvasWidth&&i>=0&&i<this.canvasHeight){var s=this.allScenes[this.mainSceneIdx],r=this.vCross(s.camera.up,s.camera.dir),o=2*Math.tan(s.camera.fov[0]),c=2*Math.tan(s.camera.fov[1]),l=o/this.canvasWidth,u=c/this.canvasHeight,d=l*(this.canvasWidth/2-a-.5),h=u*(this.canvasHeight/2-i-.5),m=this.norm(this.vAdd(s.camera.dir,this.vScale(s.camera.up,h),this.vScale(r,d)));s.camera.dir=m,this.capture(this.mainSceneIdx),this.refreshCanvas()}}},vScale:function(e,t){return{x:t*e.x,y:t*e.y,z:t*e.z}},vAdd:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}))},vSubtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}},vDot:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},vCross:function(e,t){return{x:e.y*t.z-t.y*e.z,y:t.x*e.z-e.x*t.z,z:e.x*t.y-t.x*e.y}},magnitude:function(e){return Math.sqrt(this.vDot(e,e))},norm:function(e){var t=this.magnitude(e);return this.vScale(e,1/t)},refreshCanvas:function(){for(var e=this.allScenes[this.mainSceneIdx].camera.image,t=e.length,n=e.length>0?e[0].length:0,a=this.canvasWidth/n,i=this.canvasHeight/t,s=0;s<t;s++)for(var r=0;r<n;r++){var o="rgb("+256*e[s][r].x+","+256*e[s][r].y+","+256*e[s][r].z+")";this.vueCanvas.fillStyle=o,this.vueCanvas.fillRect(r*a,s*i,a,i)}},getAvgColor:function(e){return this.vScale(this.vAdd.apply(this,Object(f["a"])(e)),1/e.length)},solveQuadratic:function(e,t,n){var a=2*e,i=t*t-2*a*n;if(i>=0){var s=Math.sqrt(i);return[(-t+s)/a,(-t-s)/a]}return[]},getUV:function(e,t){t=this.vSubtract(t,e.p);var n=0===e.u.x&&0===e.v.x,a=0===e.u.y&&0===e.v.y,i=n?e.u.y:e.u.x,s=n?e.v.y:e.v.x,r=n||a?e.u.z:e.u.y,o=n||a?e.v.z:e.v.y,c=n?t.y:t.x,l=n||a?t.z:t.y,u=1/(i*o-s*r),d=(o*c-s*l)*u,h=(i*l-r*c)*u;return[d,h]},getRayPoint:function(e,t){return this.vAdd(e.o,this.vScale(e.dir,t))},getNormal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},n={x:0,y:0,z:0};if("plane"===e.type){var a=e;n=a.n}else if("triangle"===e.type){var i=e;n=this.norm(this.vCross(this.vSubtract(i.v1,i.v0),this.vSubtract(i.v2,i.v0)))}else if("circle"===e.type){var s=e;n=s.n}else if("parallelogram"===e.type){var r=e;n=this.norm(this.vCross(r.u,r.v))}else if("sphere"===e.type){var o=e;n=this.norm(this.vSubtract(t,o.c))}else if("tube"===e.type){var c=e;n=this.norm(this.vSubtract(t,this.vAdd(c.p,this.vScale(c.d,this.vDot(c.d,this.vSubtract(t,c.p))))))}else if("cylinder"===e.type){var l=e,u=this.norm(this.vSubtract(l.p1,l.p0)),d=this.vAdd(l.p0,this.vScale(u,this.vDot(u,this.vSubtract(t,l.p0)))),h=this.vDot(this.vSubtract(d,l.p0),u);if(Math.abs(h)<1e-5)n=this.vScale(u,-1);else{var m=this.vDot(this.vSubtract(d,l.p1),this.vScale(u,-1));n=Math.abs(m)<1e-5?u:this.norm(this.vSubtract(t,d))}}return n},isInside:function(e,t){if("sphere"===t.type){var n=t,a=this.vSubtract(n.c,e);return this.magnitude(a)<=n.r}return t.type,!1},intersect:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];if("plane"===t.type){var s=t,r=this.vDot(s.n,e.dir);if(0!==r){var o=this.vDot(s.n,this.vSubtract(s.p,e.o))/r;i=o>0?[o]:[]}}else if("triangle"===t.type){var c=t,l=this.getNormal(t),u=this.intersect(e,{type:"plane",p:c.v0,n:l});if(null!==u){var d=this.getRayPoint(e,u),h=this.vSubtract(c.v1,c.v0),m=this.vSubtract(c.v2,c.v1),p=this.vSubtract(c.v0,c.v2),v=this.vCross(h,this.vSubtract(d,c.v0)),g=this.vCross(m,this.vSubtract(d,c.v1)),b=this.vCross(p,this.vSubtract(d,c.v2)),w=this.vDot(l,v)>=0&&this.vDot(l,g)>=0&&this.vDot(l,b)>=0;i=w?[u]:[]}}else if("circle"===t.type){var y=t,x=this.intersect(e,{type:"plane",p:y.c,n:y.n});if(null!==x){var S=this.vSubtract(this.getRayPoint(e,x),y.c);i=this.vDot(S,S)<=y.r*y.r?[x]:[]}}else if("parallelogram"===t.type){var k=t,C=this.getNormal(t),_=this.intersect(e,{type:"plane",p:k.p,n:C});if(null!==_){var I=this.getRayPoint(e,_),T=this.getUV(k,I),R=T[0],z=T[1],D=R>=0&&R<=1&&z>=0&&z<=1;i=D?[_]:[]}}else if("sphere"===t.type){var j=t,L=this.vDot(e.dir,e.dir),E=2*this.vDot(e.dir,this.vSubtract(e.o,j.c)),M=this.vDot(e.o,e.o)+this.vDot(j.c,j.c)-2*this.vDot(e.o,j.c)-j.r*j.r;i=this.solveQuadratic(L,E,M)}else if("tube"===t.type){var O=t,A=this.vSubtract(e.dir,this.vScale(O.d,this.vDot(O.d,e.dir))),P=this.vSubtract(e.o,O.p),V=this.vSubtract(P,this.vScale(O.d,this.vDot(O.d,P))),$=this.vDot(A,A),W=2*this.vDot(A,V),N=this.vDot(V,V)-O.r*O.r;i=this.solveQuadratic($,W,N)}else if("cylinder"===t.type){var B=t,U=this.norm(this.vSubtract(B.p1,B.p0));i=[];var q=this.intersect(e,{type:"tube",p:B.p0,d:U,r:B.r});if(q&&q>0){var H=this.vAdd(e.o,this.vScale(e.dir,q)),F=this.vAdd(B.p0,this.vScale(U,this.vDot(U,this.vSubtract(H,B.p0)))),G=this.vDot(this.vSubtract(F,B.p0),U),Q=this.vDot(this.vSubtract(F,B.p1),this.vScale(U,-1));G>=0&&Q>=0&&i.push(q);var J={type:"circle",c:B.p0,n:this.vScale(U,-1),r:B.r},Y={type:"circle",c:B.p1,n:U,r:B.r},K=this.intersect(e,J),Z=this.intersect(e,Y);K&&i.push(K),Z&&i.push(Z)}}var X=null;if(i=i.filter((function(e){return e>0})),0===i.length)return null;if(t.nullVolumes&&0!==t.nullVolumes.length){this.doOut&&console.log("Beginning NV check."),i.sort(),X=i[0];var ee=t.nullVolumes,te=!0,ne=function(){n.doOut&&console.log("Starting while loop");var t=n.getRayPoint(e,X);n.doOut&&console.log("t: "+X.toFixed(2)),n.doOut&&console.log("p: "+n.vec3ToStr(t));var a=null,s=null;ee.forEach((function(r,o){if(n.doOut&&console.log("Testing NV "+o+":"),n.doOut&&console.log(r),n.isInside(t,r)){n.doOut&&console.log("p is inside nv.");var c=n.intersect(e,r,!0);if(null!==c){if(n.doOut&&console.log("nvT: "+c.toFixed(2)),i=i.filter((function(e){return e>c})),0===i.length)return null;(null===a||a<c)&&(n.doOut&&console.log("asdf"),a=c,s=o),n.doOut&&console.log("asdf2")}else n.doOut&&console.log("!!! shouldn't be here")}})),i.length>0&&null!==a&&null!==s?(n.doOut&&console.log("setting t to "+a),X=a,ee.splice(s,1),te=ee.length>0):(n.doOut&&console.log("No new nv intersections found"),te=!1)};while(te)ne();this.doOut&&console.log("Final t = "+X.toFixed(2))}else X=a?Math.max.apply(Math,Object(f["a"])(i)):Math.min.apply(Math,Object(f["a"])(i));return X&&isFinite(X)?X:null},getColor:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;n=-1===n?this.mainSceneIdx:n;var a=this.allScenes[n],i=null,s=-1;a.items.forEach((function(n,a){var r=t.intersect(e,n);null!=r&&(null===i||r<i)&&(i=r,s=a)}));var r=-2===s?{x:1,y:1,z:1}:a.voidColor?a.voidColor:{x:0,y:0,z:0};if(s>=0&&null!==i){var o=this.getRayPoint(e,i),c=a.items[s],l=this.getNormal(c,o),u=this.norm(this.vSubtract(a.camera.pos,o)),d=c.material.ka*a.A,h=this.getRayPoint(e,.9999*i);a.lights.forEach((function(e){for(var n=!0,i=t.vSubtract(e.p,h),s=t.magnitude(i),r={o:h,dir:t.vScale(i,1/s)},m=0;m<a.items.length;m++){var p=a.items[m],f=t.intersect(r,p);if(null!=f&&f<s){n=!1;break}}if(n){var v=t.vSubtract(e.p,o),g=t.norm(v),b=e.C*c.material.kd*Math.max(0,t.vDot(g,l)),w=t.vSubtract(t.vScale(l,2*t.vDot(g,l)),g);b+=e.C*c.material.ks*Math.max(0,Math.pow(t.vDot(w,u),c.material.n)),d+=b/t.vDot(v,v)}}));var m=c.material.color;if("parallelogram"===c.type&&(c.material.image||null!=c.material.imgSrcSceneIdx)){var p=null!=c.material.imgSrcSceneIdx?this.allScenes[c.material.imgSrcSceneIdx].camera.image:c.material.image?c.material.image:[[{x:0,y:1,z:1}]],f=p.length,v=p[0].length,g=this.getUV(c,o),b=Math.min(Math.floor((1-g[1])*f),f-1),w=Math.min(Math.floor(g[0]*v),v-1);m=p[b][w]}var y=this.vScale(m,d),x=y;if(e.reflectLvl<a.camera.settings.reflectLimit&&c.material.reflectivity>0){var S=this.vSubtract(this.vScale(l,2*this.vDot(u,l)),u),k={o:h,dir:S,reflectLvl:e.reflectLvl+1,refractLvl:e.refractLvl};x=this.getColor(k,n)}r=this.vAdd(this.vScale(y,1-c.material.reflectivity),this.vScale(x,c.material.reflectivity))}return r},generateCanvasImage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.startTime=Cn()(),n=e.allScenes[e.mainSceneIdx],a=new Set,n.items.forEach((function(e){"parallelogram"===e.type&&null!=e.material.imgSrcSceneIdx&&a.add(e.material.imgSrcSceneIdx)})),e.subSceneCount=a.size,a.forEach((function(t){return e.capture(t)})),e.capture(e.mainSceneIdx),e.refreshCanvas(),e.endTime=Cn()();case 9:case"end":return t.stop()}}),t)})))()},capture:function(e){var t={};t.start=Cn()();var n=this.allScenes[e];this.doGlobalCameraSettings&&(n.camera.settings=this.canvasSettings);var a=n.camera.settings.pxRows,i=n.camera.settings.pxCols;n.camera.image=new Array(a).fill(0).map((function(){return new Array(i).fill({x:0,y:1,z:1})}));for(var s=this.vCross(n.camera.up,n.camera.dir),r=2*Math.tan(n.camera.fov[0]),o=2*Math.tan(n.camera.fov[1]),c=r/i,l=o/a,u=0;u<a;u++)for(var d=l*(a/2-u-.5),h=0;h<i;h++){for(var m=c*(i/2-h-.5),p=[],f=n.camera.settings.superSampleLvl,v=0;v<f;v++)for(var g=l/f*(f/2-v-.5),b=0;b<f;b++){var w=c/f*(f/2-b-.5),y=this.norm(this.vAdd(n.camera.dir,this.vScale(n.camera.up,d+g),this.vScale(s,m+w))),x={o:n.camera.pos,dir:y,reflectLvl:0,refractLvl:0};p.push(this.getColor(x,e))}var S=this.getAvgColor(p);this.doOut&&(S={x:1,y:0,z:0}),n.camera.image[u][h]=S}t.end=Cn()(),t.sceneIdx=e,t.sceneSettings=n.camera.settings,this.captureTimes.push(t)},unpackCompound:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(t=-1===t?this.mainSceneIdx:t,"polygon"===e.type)for(var n=e,a=n.vertices.length,i=2;i<a;i++)this.allScenes[t].items.push({type:"triangle",material:n.material,v0:n.vertices[0],v1:n.vertices[i-1],v2:n.vertices[i]});else if("smoothPolygon"===e.type)for(var s=e,r=s.vertices.length,o=0;o<r;o++)if(this.allScenes[t].items.push({type:"sphere",material:s.material,c:s.vertices[o],r:s.r}),this.allScenes[t].items.push({type:"cylinder",material:s.material,p0:s.vertices[o],p1:s.vertices[o+1>r-1?0:o+1],r:s.r}),o>1)for(var c=[{type:"triangle",material:s.material,v0:s.vertices[0],v1:s.vertices[o],v2:s.vertices[o-1]},{type:"triangle",material:s.material,v0:s.vertices[0],v1:s.vertices[o-1],v2:s.vertices[o]}],l=0;l<2;l++){var u=this.vScale(this.norm(this.vCross(this.vSubtract(c[l].v2,c[l].v0),this.vSubtract(c[l].v1,c[l].v0))),-s.r);c[l].v0=this.vAdd(c[l].v0,u),c[l].v1=this.vAdd(c[l].v1,u),c[l].v2=this.vAdd(c[l].v2,u),this.allScenes[t].items.push(c[l])}},aAdd:function(e,t){return e.map((function(e,n){return e+t[n]}))},aScale:function(e,t){return e.map((function(e){return e*t}))},getGrayscale:function(e){return e.map((function(e){return e.map((function(e){return.299*e[0]+.587*e[1]+.114*e[2]}))}))},getEdgeMap:function(e){for(var t=this.getGrayscale(e),n=t.length,a=t.length>0?t[0].length:0,i=new Array(n).fill(0).map((function(){return new Array(a).fill(0)})),s=function(e){for(var s=function(s){var r=t[e][s],o=[];e>0&&o.push(t[e-1][s]),e<n-1&&o.push(t[e+1][s]),s>0&&o.push(t[e][s-1]),s<a-1&&o.push(t[e][s+1]),o.forEach((function(t){Math.abs(r-t)>.1&&(i[e][s]=1)}))},r=0;r<a;r++)s(r)},r=0;r<n;r++)s(r);return i},blurCross:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.cMat.length,n=this.cMat.length>0?this.cMat[0].length:0,a=0;a<t;a++)for(var i=0;i<n;i++)if(null===e||1===e[a][i]){var s=3,r=this.aScale(this.cMat[a][i],3);a>0&&(r=this.aAdd(r,this.cMat[a-1][i]),s++),a<t-1&&(r=this.aAdd(r,this.cMat[a+1][i]),s++),i>0&&(r=this.aAdd(r,this.cMat[a][i-1]),s++),i<n-1&&(r=this.aAdd(r,this.cMat[a][i+1]),s++);var o=this.aScale(r,1/s);this.cMat[a][i]=o}this.refreshCanvas()},get3dFrom2d:function(e){return e.map((function(e){return e.map((function(e){return[e,e,e]}))}))},vec3ToStr:function(e){return"{ "+e.x.toFixed(2)+", "+e.y.toFixed(2)+", "+e.z.toFixed(2)+" }"}}}),In=_n,Tn=Object(J["a"])(In,xn,Sn,!1,null,"09982d7d",null),Rn=Tn.exports,zn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex"}},[n("div",[n("div",{style:"font-weight: bold; background-color: "+(e.pen.element?e.vec2RGB(e.pen.element.color):"#eee")+"; border-radius: 4px; margin: 1px; text-align: center;"},[e._v(" "+e._s(e.pen.element?e.pen.element.name:"Eraser")+" ")]),n("div",{staticStyle:{height:"200px","overflow-y":"auto"}},e._l([null].concat(e.elementsList),(function(t,a){return n("div",{key:a,style:"background-color: "+(t?e.vec2RGB(t.color):"#eee")+"; border-radius: 4px; margin: 1px; text-align: center; cursor: pointer",on:{click:function(n){e.pen.element=t}}},[e._v(" "+e._s(t?t.name:"Eraser")+" ")])})),0)]),n("div",{staticStyle:{position:"relative"}},[n("canvas",{staticStyle:{"margin-left":"10px",border:"1px solid #000000"},attrs:{id:"c",width:e.canvasWidth,height:e.canvasHeight},on:{click:function(t){return e.drawMouseEvent(t)},mousemove:function(t){e.pen.isDrawing&&e.drawMouseEvent(t)},mousedown:function(t){e.pen.isDrawing=!0},mouseup:function(t){e.pen.isDrawing=!1},mouseleave:function(t){e.pen.isDrawing=!1}}}),n("div",[n("button",{staticStyle:{"background-color":"#78f"},on:{click:function(t){return e.doTick()}}},[e._v(" tick++ ")]),n("button",{staticStyle:{"background-color":"#f87"},on:{click:function(t){return e.resetScene()}}},[e._v(" reset ")])]),n("div",[n("button",{staticStyle:{"background-color":"#7ce"},on:{click:function(t){e.doAutoTick=!e.doAutoTick}}},[e._v(" "+e._s(e.doAutoTick?"Pause":"Run")+" ")])]),n("div",[n("button",{style:"background-color: "+(e.scene.isCeiling?"#8ac":"#468"),on:{click:function(t){e.scene.isCeiling=!e.scene.isCeiling}}},[e._v(" Ceiling: "+e._s(e.scene.isCeiling?"On":"Off")+" ")]),n("button",{style:"background-color: "+(e.scene.isFloor?"#ca8":"#864"),on:{click:function(t){e.scene.isFloor=!e.scene.isFloor}}},[e._v(" Floor: "+e._s(e.scene.isFloor?"On":"Off")+" ")])]),n("div",[e._v(" Tick: "+e._s(e.scene.tick)+" ")]),e._v(" Pen size: "),n("b-form-spinbutton",{staticStyle:{margin:"10px 5px"},attrs:{min:"1",max:"20",wrap:"",inline:""},model:{value:e.pen.size,callback:function(t){e.$set(e.pen,"size",t)},expression:"pen.size"}})],1)])},Dn=[],jn=(n("38cf"),50),Ln={oil:{name:"oil",state:"liquid",density:.5,isActive:!1,reactions:[],color:{x:.7,y:.3,z:0}},ash:{name:"ash",state:"sediment",isActive:!1,reactions:[],color:{x:.7,y:.7,z:.7}},dirt:{name:"dirt",state:"sediment",isActive:!1,reactions:[],color:{x:.4,y:.3,z:0}},sand:{name:"sand",state:"sediment",isActive:!1,reactions:[],color:{x:.9,y:.8,z:.5}},ice:{name:"ice",state:"solid",isActive:!1,reactions:[],color:{x:.6,y:.7,z:1}},steel:{name:"steel",state:"solid",isActive:!1,reactions:[],color:{x:.85,y:.85,z:.85}},stone:{name:"stone",state:"solid",isActive:!1,reactions:[],color:{x:.6,y:.6,z:.6}},wire:{name:"wire",state:"solid",isActive:!1,reactions:[],color:{x:.6,y:.1,z:.6}},wood:{name:"wood",state:"solid",isActive:!1,reactions:[],color:{x:.6,y:.5,z:0}},fire:{name:"fire",state:"gas",isActive:!0,reactions:[{reactee:"oil",result:"fire",isTransitive:!0,chance:1},{reactee:"ice",result:"water",isTransitive:!0,chance:1},{reactee:"wood",result:"ember",isTransitive:!0,chance:.1},{reactee:"water",result:"steam",isTransitive:!1,chance:1}],color:{x:1,y:.2,z:0},decay:{startAge:5e3/jn,endAge:2e4/jn,result:"smoke"}},methane:{name:"methane",state:"gas",isActive:!0,reactions:[{reactee:"air",result:"air",isTransitive:!1,chance:.01},{reactee:"fire",result:"fire",isTransitive:!1,chance:1}],color:{x:.5,y:.4,z:.2}},smoke:{name:"smoke",state:"gas",isActive:!0,reactions:[],decay:{startAge:2e3/jn,endAge:1e4/jn,result:"air"},color:{x:.5,y:.4,z:.4}},steam:{name:"steam",state:"gas",isActive:!0,reactions:[{reactee:"air",result:"air",isTransitive:!1,chance:.01},{reactee:"ice",result:"water",isTransitive:!1,chance:.2},{reactee:"plant",result:"plant",isTransitive:!1,chance:.1}],decay:{startAge:15e3/jn,endAge:6e4/jn,result:"spark"},color:{x:.6,y:.8,z:1}},water:{name:"water",state:"liquid",isActive:!0,reactions:[{reactee:"dirt",result:"plant",isTransitive:!1,chance:.001},{reactee:"steel",result:"rust",isTransitive:!0,chance:.01},{reactee:"fire",result:"steam",isTransitive:!1,chance:1},{reactee:"plant",result:"plant",isTransitive:!1,chance:.6}],color:{x:.2,y:.3,z:1}},spark:{name:"spark",state:"sediment",isActive:!0,reactions:[{reactee:"oil",result:"fire",isTransitive:!0,chance:1}],decay:{startAge:1e3/jn,endAge:5e3/jn,result:"air"},color:{x:.9,y:.9,z:0}},ember:{name:"ember",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"fire",isTransitive:!0,chance:.2},{reactee:"ice",result:"water",isTransitive:!0,chance:.1},{reactee:"wood",result:"ember",isTransitive:!0,chance:.01},{reactee:"water",result:"ash",isTransitive:!1,chance:.05}],decay:{startAge:5e3/jn,endAge:2e4/jn,result:"ash"},color:{x:.3,y:.3,z:.3}},plant:{name:"plant",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"plant",isTransitive:!0,chance:.01},{reactee:"ash",result:"plant",isTransitive:!0,chance:.001},{reactee:"dirt",result:"wood",isTransitive:!0,chance:.001},{reactee:"methane",result:"humus",isTransitive:!1,chance:.01},{reactee:"oil",result:"humus",isTransitive:!1,chance:.01},{reactee:"ice",result:"humus",isTransitive:!1,chance:.01},{reactee:"wood",result:"wood",isTransitive:!1,chance:.001},{reactee:"fire",result:"fire",isTransitive:!1,chance:1},{reactee:"humus",result:"humus",isTransitive:!1,chance:.01}],color:{x:.2,y:.8,z:.3}},humus:{name:"humus",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"methane",isTransitive:!1,chance:.01},{reactee:"methane",result:"methane",isTransitive:!1,chance:.05},{reactee:"fire",result:"fire",isTransitive:!1,chance:1}],color:{x:.6,y:.9,z:.3}},rust:{name:"rust",state:"solid",isActive:!0,reactions:[{reactee:"oil",result:"air",isTransitive:!1,chance:.1},{reactee:"steel",result:"rust",isTransitive:!0,chance:.005},{reactee:"steel+",result:"smoke",isTransitive:!1,chance:1}],decay:{startAge:1e4/jn,endAge:2e4/jn,result:"air"},color:{x:.5,y:.3,z:0}},"steel+":{name:"steel+",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"spark",isTransitive:!0,chance:.75},{reactee:"steel",result:"steel+",isTransitive:!0,chance:1}],decay:{startAge:2,endAge:2,result:"steel"},color:{x:.95,y:.95,z:.5}},"wire+":{name:"wire+",state:"solid",isActive:!0,reactions:[{reactee:"wire",result:"wire+",isTransitive:!0,chance:1},{reactee:"steel",result:"steel+",isTransitive:!0,chance:1}],decay:{startAge:2,endAge:2,result:"wire"},color:{x:.9,y:.3,z:.9}},pump:{name:"pump",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"oil",isTransitive:!0,chance:.5}],color:{x:.8,y:.6,z:.3}},torch:{name:"torch",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"fire",isTransitive:!0,chance:.5}],color:{x:.5,y:.3,z:0}},well:{name:"well",state:"solid",isActive:!0,reactions:[{reactee:"air",result:"water",isTransitive:!0,chance:.5}],color:{x:0,y:0,z:.8}}},En=a["default"].extend({name:"SandboxGame",data:function(){return{scene:{image:[],particles:[],tick:0,isCeiling:!0,isFloor:!0},pen:{element:Ln["sand"],size:3,isDrawing:!1},vueCanvas:{},imgRows:50,imgCols:50,canvasWidth:250,canvasHeight:250,interval:void 0,doAutoTick:!1}},computed:{backgroundImage:function(){for(var e=this,t={x:.05,y:.05,z:.05},n={x:.15,y:.15,z:.15},a=new Array(this.imgRows).fill(0).map((function(){return new Array(e.imgCols).fill(t)})),i=0;i<this.imgRows;i++)for(var s=0;s<this.imgCols;s++)a[i][s]=(i+s)%2===0?t:n;return a},elementsList:function(){return Object.keys(Ln).map((function(e){return Ln[e]}))}},created:function(){var e=this;this.initializeScene(),this.$nextTick((function(){var t=document.getElementById("c"),n=t.getContext("2d"),a=function(t){t.preventDefault(),e.drawTouchEvent(t)};t.addEventListener("touchstart",a,{passive:!1}),t.addEventListener("touchmove",e.drawTouchEvent),null!==n&&(e.vueCanvas=n,e.renderScene())})),this.interval=setInterval((function(){e.doAutoTick&&e.doTick()}),jn)},destroyed:function(){clearInterval(this.interval)},methods:{trimToLength:function(e,t){return e.substring(0,t)+(e.length<t?" ".repeat(t-e.length):"")},vec2Str:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"( "+e.x.toFixed(t)+", "+e.y.toFixed(t)+", "+e.z.toFixed(t)+" )"},particle2Str:function(e){return this.trimToLength(null===e?" - ":e.material.name,3)},particleRow2Str:function(e){var t=this,n=[];return e.forEach((function(e){n.push(t.particle2Str(e))})),"[ "+n.join(", ")+" ]"},imageRow2Str:function(e){var t=this,n=[];return e.forEach((function(e){n.push(t.trimToLength(t.vec2Str(e),20))})),"[ "+n.join(", ")+" ]"},printImgData:function(){var e=this;console.log("Particles --------------"),this.scene.particles.forEach((function(t){console.log(e.particleRow2Str(t))})),console.log("--------------------")},testDrag:function(e){console.log("drag detected:"),console.log(e)},vec2RGB:function(e){return"rgb("+256*e.x+", "+256*e.y+", "+256*e.z+")"},setParticle:function(e,t,n){this.scene.particles[e][t]=n?{material:n,birthTick:this.scene.tick}:null},drawMouseEvent:function(e){var t=document.getElementById("c"),n=t.getBoundingClientRect(),a=e.clientX-n.left-1,i=e.clientY-n.top-1;this.draw(a,i)},drawTouchEvent:function(e){var t=document.getElementById("c"),n=t.getBoundingClientRect(),a=e.touches[0].clientX-n.left-1,i=e.touches[0].clientY-n.top-1;this.draw(a,i)},draw:function(e,t){for(var n=Math.floor(t*this.imgRows/this.canvasHeight),a=Math.floor(e*this.imgCols/this.canvasWidth),i=Math.floor(this.pen.size/2),s=n-i;s<=n+i;s++)for(var r=a-i;r<=a+i;r++)r>=0&&r<this.imgCols&&s>=0&&s<this.imgRows&&this.setParticle(s,r,this.pen.element);this.renderScene()},initializeScene:function(){var e=this;this.scene.image=v.deepClone(this.backgroundImage),this.scene.particles=new Array(this.imgRows).fill(0).map((function(){return new Array(e.imgCols).fill(null)}));var t=[];t.forEach((function(t){for(var n=t.startRow;n<t.startRow+t.height;n++)if(n>=0&&n<e.imgRows)for(var a=t.startCol;a<t.startCol+t.width;a++)a>=0&&a<e.imgCols&&e.setParticle(n,a,"air"===t.element?null:Ln[t.element])}))},resetScene:function(){this.scene.tick=0,this.initializeScene(),this.renderScene()},doTick:function(){this.scene.tick%2===0?this.react():this.move(),this.scene.tick++,this.renderScene()},getNewParticle:function(e){return"air"===e?null:{material:Ln[e],birthTick:this.scene.tick}},isDenser:function(e,t){if(e.material.state===t.material.state){var n=void 0===e.material.density?1:e.material.density,a=void 0===t.material.density?1:t.material.density;return n>a}var i={gas:0,liquid:1,sediment:2};return i[e.material.state]>i[t.material.state]},doesChanceSucceed:function(e){return Math.random()<e},doesDecayOccur:function(e){if(e.material.decay){var t=this.scene.tick-e.birthTick,n=(t-e.material.decay.startAge)/(e.material.decay.endAge-e.material.decay.startAge);return this.doesChanceSucceed(n)}return!1},react:function(){var e=this,t=v.deepClone(this.scene.particles),n=new Array(this.imgRows).fill(0).map((function(){return new Array(e.imgCols).fill(!1)}));this.scene.particles.forEach((function(a,i){a.forEach((function(a,s){if(null!==a&&a.material.isActive)if(e.doesDecayOccur(a)){var r=a.material.decay.result;t[i][s]=e.getNewParticle(r),n[i][s]=!0}else{var o=[];if(i>0){var c=null===e.scene.particles[i-1][s]?"air":e.scene.particles[i-1][s].material.name;if(c!==a.material.name){var l=a.material.reactions.find((function(e){return e.reactee===c}));if(void 0!==l){var u=v.deepClone(l);u.direction=[-1,0],o.push(u)}}}if(i<e.imgRows-1){var d=null===e.scene.particles[i+1][s]?"air":e.scene.particles[i+1][s].material.name;if(d!==a.material.name){var h=a.material.reactions.find((function(e){return e.reactee===d}));if(void 0!==h){var m=v.deepClone(h);m.direction=[1,0],o.push(m)}}}if(s>0){var p=null===e.scene.particles[i][s-1]?"air":e.scene.particles[i][s-1].material.name;if(p!==a.material.name){var f=a.material.reactions.find((function(e){return e.reactee===p}));if(void 0!==f){var g=v.deepClone(f);g.direction=[0,-1],o.push(g)}}}if(s<e.imgCols-1){var b=null===e.scene.particles[i][s+1]?"air":e.scene.particles[i][s+1].material.name;if(b!==a.material.name){var w=a.material.reactions.find((function(e){return e.reactee===b}));if(void 0!==w){var y=v.deepClone(w);y.direction=[0,1],o.push(y)}}}o.sort((function(e,t){return e.isTransitive!==t.isTransitive?e.isTransitive?1:-1:t.chance-e.chance}));for(var x=0;x<o.length;x++){var S=o[x];if(e.doesChanceSucceed(S.chance)){if(!S.isTransitive){t[i][s]=e.getNewParticle(S.result),n[i][s]=!0;break}t[i+S.direction[0]][s+S.direction[1]]=e.getNewParticle(S.result),n[i+S.direction[0]][s+S.direction[1]]=!0}}}}))})),this.scene.particles=v.deepClone(t)},move:function(){var e=this,t=v.deepClone(this.scene.particles),n=new Array(this.imgRows).fill(0).map((function(){return new Array(e.imgCols).fill(!1)}));this.scene.particles.forEach((function(a,i){a.forEach((function(a,s){if(null!==a&&"solid"!==a.material.state){var r=!1;if("gas"===a.material.state){if(i>0){var o=e.scene.particles[i-1][s];n[i-1][s]||(null===o?(t[i-1][s]=a,n[i-1][s]=!0,t[i][s]=null,r=!0):e.isDenser(o,a)&&(t[i-1][s]=a,t[i][s]=o,n[i-1][s]=!0,n[i][s]=!0,r=!0))}else e.scene.isCeiling||(t[i][s]=null,r=!0);if(!r){var c=s>0&&null==e.scene.particles[i][s-1]&&!n[i][s-1],l=c&&i>0&&null==e.scene.particles[i-1][s-1]&&!n[i-1][s-1],u=s<e.imgCols-1&&null==e.scene.particles[i][s+1]&&!n[i][s+1],d=u&&i>0&&null==e.scene.particles[i-1][s+1]&&!n[i-1][s+1];if(l||d){var h=l&&d?e.doesChanceSucceed(.5):l,m=h?-1:1;t[i-1][s+m]=a,n[i-1][s+m]=!0,t[i][s]=null}else if((c||u)&&e.doesChanceSucceed(.5)){var p=c&&u?e.doesChanceSucceed(.5):c,f=p?-1:1;t[i][s+f]=a,n[i][s+f]=!0,t[i][s]=null}}}else{if(i<e.imgRows-1){var v=e.scene.particles[i+1][s];n[i+1][s]||(null===v?(t[i+1][s]=a,n[i+1][s]=!0,t[i][s]=null,r=!0):e.isDenser(a,v)&&(t[i+1][s]=a,t[i][s]=v,n[i+1][s]=!0,n[i][s]=!0,r=!0))}else e.scene.isFloor||(t[i][s]=null,r=!0);if(!r){var g=s>0&&null==e.scene.particles[i][s-1]&&!n[i][s-1],b=g&&i<e.imgRows-1&&null==e.scene.particles[i+1][s-1]&&!n[i+1][s-1],w=s<e.imgCols-1&&null==e.scene.particles[i][s+1]&&!n[i][s+1],y=w&&i<e.imgRows-1&&null==e.scene.particles[i+1][s+1]&&!n[i+1][s+1];if(b||y){var x=b&&y?e.doesChanceSucceed(.5):b,S=x?-1:1;t[i+1][s+S]=a,n[i+1][s+S]=!0,t[i][s]=null}else if("liquid"===a.material.state&&(g||w)&&e.doesChanceSucceed(.5)){var k=g&&w?e.doesChanceSucceed(.5):g,C=k?-1:1;t[i][s+C]=a,n[i][s+C]=!0,t[i][s]=null}}}}}))})),this.scene.particles=v.deepClone(t)},renderScene:function(){var e=this;this.scene.particles.forEach((function(t,n){t.forEach((function(t,a){e.scene.image[n][a]=null===t?e.backgroundImage[n][a]:t.material.color}))})),this.refreshCanvas()},refreshCanvas:function(){for(var e=this.scene.image,t=e.length,n=e.length>0?e[0].length:0,a=this.canvasWidth/n,i=this.canvasHeight/t,s=0;s<t;s++)for(var r=0;r<n;r++){var o="rgb("+256*e[s][r].x+","+256*e[s][r].y+","+256*e[s][r].z+")";this.vueCanvas.fillStyle=o,this.vueCanvas.fillRect(r*a,s*i,a,i)}}}}),Mn=En,On=(n("9b1a"),Object(J["a"])(Mn,zn,Dn,!1,null,"407b3fe4",null)),An=On.exports,Pn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{viewBox:"0 0 "+e.pxCols+" "+e.pxRows,xmlns:"http://www.w3.org/2000/svg"}},[n("mask",{attrs:{id:"dropletMask"}},[n("rect",{attrs:{x:"0",y:"0",width:"100%",height:"100%",fill:"black"}}),n("circle",{attrs:{cx:e.R,cy:e.R,r:e.R,fill:"white"}}),n("rect",{attrs:{x:"0",y:e.R-e.de,width:"100%",height:"100%",fill:"black",transform:"rotate("+-180/e.n+", "+e.R+", "+e.R+")"}}),n("path",{attrs:{fill:"black",d:"\n        M "+e.R+" "+e.R+"\n        l 0 "+-e.R+"\n        a "+e.R+" "+e.R+" 0\n          1 1\n          "+-e.R*Math.sin(2*Math.PI/e.n)+" "+(e.R-e.R*Math.cos(2*Math.PI/e.n))+"\n        z\n      "}}),n("circle",{attrs:{cx:e.R,cy:e.r,r:e.r,fill:"white"}}),n("circle",{attrs:{cx:e.R,cy:e.r,r:e.r,transform:"rotate("+-360/e.n+", "+e.R+", "+e.R+")",fill:"black"}})]),e._l(e.n,(function(t){return n("circle",{key:"droplet"+t,attrs:{cx:e.R,cy:e.R,r:e.R,fill:"hsl("+360*t/e.n+", 50%, 60%)",mask:"url(#dropletMask)",transform:"rotate("+360*t/e.n+", "+e.R+", "+e.R+")"}})}))],2)},Vn=[],$n=a["default"].extend({name:"DropletRing",props:["n"],data:function(){return{pxRows:10,pxCols:10}},computed:{R:function(){return Math.min(this.pxRows,this.pxCols)/2},r:function(){var e=Math.sqrt(2-2*Math.cos(2*Math.PI/this.n));return this.R*e/(2+e)},de:function(){return this.r/Math.tan(Math.PI/this.n)}},methods:{}}),Wn=$n,Nn=Object(J["a"])(Wn,Pn,Vn,!1,null,null,null),Bn=Nn.exports,Un=a["default"].extend({name:"MiscTools",components:{canvasTest:Rn,imageAnalyzer:yn,sandboxGame:An,dropletRing:Bn},data:function(){return{dropletCount:3}}}),qn=Un,Hn=Object(J["a"])(qn,en,tn,!1,null,null,null),Fn=Hn.exports;a["default"].use(re["a"]);var Gn=new re["a"]({mode:"hash",base:"/bushu-app/",routes:[{path:"/",name:"Home",component:Qe},{path:"/watchlist",name:"Watchlist",component:Xt},{path:"/miscTools",name:"MiscTools",component:Fn}]}),Qn=n("5f5b"),Jn=n("b1e0"),Yn=n("2b27"),Kn=n.n(Yn),Zn=(n("f9e3"),n("2dd8"),n("00b4"),{filters:{toTitleCase:function(e){return null===e||void 0===e?void 0:e.replace(/\w*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))},formatDate:function(e){if(!e)return"?";var t=/^\d{4}-\d{2}-\d{2}$/.test(e);return v.getFormattedDate(e,t)}}});a["default"].config.productionTip=!1,a["default"].use(Qn["a"]),a["default"].use(Jn["a"]),a["default"].use(Kn.a),a["default"].mixin(Zn),new a["default"]({router:Gn,store:W,render:function(e){return e(se)}}).$mount("#app")},d597:function(e,t,n){},deb7:function(e,t,n){"use strict";n("3e98")},defd:function(e,t,n){"use strict";n("50b6")},e30f:function(e,t,n){},eb27:function(e,t,n){},ebbe:function(e,t,n){"use strict";n("c6ae")},ec5d:function(e,t,n){},fb9a:function(e,t,n){},fd94:function(e,t,n){}});
//# sourceMappingURL=app.139c0bb6.js.map